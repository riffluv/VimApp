/* --- 2025年最新 動的ビューポート単位とスケーリングシステム --- */

:root {
  /* 2025年最新: 動的ビューポート単位変数 */
  --viewport-height-small: 100svh; /* Small viewport height */
  --viewport-height-large: 100lvh; /* Large viewport height */
  --viewport-height-dynamic: 100dvh; /* Dynamic viewport height */
  --viewport-width: 100vw;

  /* レスポンシブベースフォントサイズ */
  --base-font-size: clamp(1rem, 2.5vw, 1.125rem);
  --base-line-height: 1.6;

  /* DPIスケーリング変数 */
  --dpi-scale: 1;
  --dpi-font-adjustment: 0px;

  /* 流体スペーシングシステム */
  --space-3xs: clamp(0.125rem, 0.5vw, 0.25rem); /* 2-4px */
  --space-2xs: clamp(0.25rem, 0.75vw, 0.375rem); /* 4-6px */
  --space-xs: clamp(0.375rem, 1vw, 0.5rem); /* 6-8px */
  --space-sm: clamp(0.5rem, 1.5vw, 0.75rem); /* 8-12px */
  --space-md: clamp(0.75rem, 2vw, 1.25rem); /* 12-20px */
  --space-lg: clamp(1rem, 3vw, 1.75rem); /* 16-28px */
  --space-xl: clamp(1.5rem, 4vw, 2.5rem); /* 24-40px */
  --space-2xl: clamp(2rem, 5vw, 3.5rem); /* 32-56px */
  --space-3xl: clamp(3rem, 8vw, 5rem); /* 48-80px */

  /* 流体タイポグラフィスケール */
  --text-xs: clamp(0.75rem, 1.5vw, 0.875rem);
  --text-sm: clamp(0.875rem, 1.75vw, 1rem);
  --text-base: var(--base-font-size);
  --text-lg: clamp(1.125rem, 2.25vw, 1.25rem);
  --text-xl: clamp(1.25rem, 2.75vw, 1.5rem);
  --text-2xl: clamp(1.5rem, 3.5vw, 2rem);
  --text-3xl: clamp(1.875rem, 4.5vw, 2.5rem);
  --text-4xl: clamp(2.25rem, 5.5vw, 3rem);
  --text-5xl: clamp(3rem, 7vw, 4rem);

  /* アダプティブレイアウト変数 */
  --container-padding: clamp(1rem, 5vw, 3rem);
  --content-max-width: clamp(20rem, 90vw, 80rem);
  --sidebar-width: clamp(15rem, 25vw, 20rem);
  --header-height: clamp(3.5rem, 8vh, 5rem);

  /* ダイナミックスケーリング */
  --scale-factor: clamp(0.8, 1vw + 0.5rem, 1.2);
  --interactive-scale: clamp(1, 1.2vw + 0.8rem, 1.1);
}

/* DPI 125%対応（Windows標準） */
@media (resolution: 1.25dppx) {
  :root {
    --dpi-scale: 1.25;
    --dpi-font-adjustment: 2px;
    --base-font-size: clamp(1.05rem, 2.6vw, 1.2rem);

    /* 125%スケール時の調整 */
    --space-xs: clamp(0.4rem, 1.1vw, 0.55rem);
    --space-sm: clamp(0.55rem, 1.6vw, 0.8rem);
    --space-md: clamp(0.8rem, 2.1vw, 1.3rem);
    --space-lg: clamp(1.05rem, 3.1vw, 1.8rem);
    --space-xl: clamp(1.6rem, 4.1vw, 2.6rem);
  }
}

/* DPI 150%対応 */
@media (resolution: 1.5dppx) {
  :root {
    --dpi-scale: 1.5;
    --dpi-font-adjustment: 3px;
    --base-font-size: clamp(1.1rem, 2.7vw, 1.25rem);
  }
}

/* DPI 175%対応 */
@media (resolution: 1.75dppx) {
  :root {
    --dpi-scale: 1.75;
    --dpi-font-adjustment: 4px;
    --base-font-size: clamp(1.15rem, 2.8vw, 1.3rem);
  }
}

/* DPI 200%対応 */
@media (resolution: 2dppx) {
  :root {
    --dpi-scale: 2;
    --dpi-font-adjustment: 5px;
    --base-font-size: clamp(1.2rem, 2.9vw, 1.35rem);
  }
}

/* ビューポート高度対応 */
@supports (height: 100dvh) {
  .dynamic-height {
    min-height: var(--viewport-height-dynamic);
  }
}

@supports not (height: 100dvh) {
  .dynamic-height {
    min-height: 100vh;
  }
}

/* モバイル最適化（小さいビューポート） */
@media (max-height: 600px) {
  :root {
    --header-height: clamp(2.5rem, 6vh, 3.5rem);
    --space-lg: clamp(0.75rem, 2.5vw, 1.25rem);
    --space-xl: clamp(1rem, 3.5vw, 1.75rem);
  }
}

/* 大画面最適化 */
@media (min-width: 1920px) {
  :root {
    --content-max-width: clamp(60rem, 80vw, 100rem);
    --container-padding: clamp(2rem, 8vw, 6rem);
  }
}

/* 超大画面対応（4K等） */
@media (min-width: 2560px) {
  :root {
    --base-font-size: clamp(1.125rem, 2vw, 1.25rem);
    --content-max-width: clamp(80rem, 75vw, 120rem);
  }
}

/* 縦画面対応 */
@media (orientation: portrait) {
  :root {
    --sidebar-width: clamp(12rem, 35vw, 18rem);
    --container-padding: clamp(0.75rem, 4vw, 2rem);
  }
}

/* 横画面対応 */
@media (orientation: landscape) {
  :root {
    --sidebar-width: clamp(15rem, 20vw, 25rem);
  }
}

/* 動的スケーリングユーティリティクラス */
.fluid-scale {
  transform: scale(var(--scale-factor));
  transform-origin: center;
}

.interactive-scale {
  transform: scale(var(--interactive-scale));
  transition: transform 0.2s ease;
}

.interactive-scale:hover {
  transform: scale(calc(var(--interactive-scale) * 1.05));
}

.responsive-padding {
  padding: var(--container-padding);
}

.responsive-margin {
  margin: var(--space-lg) auto;
}

.responsive-gap {
  gap: var(--space-md);
}

/* フォントサイズユーティリティ */
.text-fluid-xs {
  font-size: var(--text-xs);
}
.text-fluid-sm {
  font-size: var(--text-sm);
}
.text-fluid-base {
  font-size: var(--text-base);
}
.text-fluid-lg {
  font-size: var(--text-lg);
}
.text-fluid-xl {
  font-size: var(--text-xl);
}
.text-fluid-2xl {
  font-size: var(--text-2xl);
}
.text-fluid-3xl {
  font-size: var(--text-3xl);
}
.text-fluid-4xl {
  font-size: var(--text-4xl);
}
.text-fluid-5xl {
  font-size: var(--text-5xl);
}

/* スペーシングユーティリティ */
.space-fluid-xs {
  margin: var(--space-xs);
}
.space-fluid-sm {
  margin: var(--space-sm);
}
.space-fluid-md {
  margin: var(--space-md);
}
.space-fluid-lg {
  margin: var(--space-lg);
}
.space-fluid-xl {
  margin: var(--space-xl);
}

.gap-fluid-xs {
  gap: var(--space-xs);
}
.gap-fluid-sm {
  gap: var(--space-sm);
}
.gap-fluid-md {
  gap: var(--space-md);
}
.gap-fluid-lg {
  gap: var(--space-lg);
}
.gap-fluid-xl {
  gap: var(--space-xl);
}

.padding-fluid-xs {
  padding: var(--space-xs);
}
.padding-fluid-sm {
  padding: var(--space-sm);
}
.padding-fluid-md {
  padding: var(--space-md);
}
.padding-fluid-lg {
  padding: var(--space-lg);
}
.padding-fluid-xl {
  padding: var(--space-xl);
}

/* レイアウトユーティリティ */
.container-responsive {
  max-width: var(--content-max-width);
  margin: 0 auto;
  padding: 0 var(--container-padding);
}

.sidebar-responsive {
  width: var(--sidebar-width);
  min-width: var(--sidebar-width);
}

.header-responsive {
  height: var(--header-height);
  min-height: var(--header-height);
}

/* アスペクト比対応 */
.aspect-responsive {
  aspect-ratio: 16 / 9;
}

@media (max-width: 768px) {
  .aspect-responsive {
    aspect-ratio: 4 / 3;
  }
}

@media (max-width: 480px) {
  .aspect-responsive {
    aspect-ratio: 1 / 1;
  }
}

/* パフォーマンス最適化 */
.gpu-accelerate {
  transform: translateZ(0);
  will-change: transform;
  backface-visibility: hidden;
}

.contain-layout {
  contain: layout style;
}

.contain-strict {
  contain: strict;
}

/* デバッグ用ユーティリティ（開発時のみ） */
.debug-viewport::before {
  content: "VW: " attr(data-vw) " | VH: " attr(data-vh) " | DPR: "
    attr(data-dpr);
  position: fixed;
  top: 0;
  right: 0;
  background: rgba(255, 0, 0, 0.8);
  color: white;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  z-index: 9999;
  pointer-events: none;
}
