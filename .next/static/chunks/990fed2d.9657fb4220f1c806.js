"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{7037:function(e,t,n){let r,i;n.d(t,{dV:function(){return F},rd:function(){return V}});var o=n(800),a=n(4241),s=n(7924),l=n(548),c=n(2040);function u(e,t){var n=t.ch,r=t.line+1;r<1&&(r=1,n=0),r>e.lines&&(r=e.lines,n=Number.MAX_VALUE);var i=e.line(r);return Math.min(i.from+Math.max(0,n),i.to)}function h(e,t){let n=e.lineAt(t);return{line:n.number-1,ch:t-n.from}}class d{constructor(e,t){this.line=e,this.ch=t}}function m(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else{var r=e._handlers||(e._handlers={});r[t]=(r[t]||[]).concat(n)}}function p(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else{var r=e._handlers,i=r&&r[t];if(i){var o=i.indexOf(n);o>-1&&(r[t]=i.slice(0,o).concat(i.slice(o+1)))}}}function f(e,t,...n){var r,i=null===(r=e._handlers)||void 0===r?void 0:r[t];if(i)for(var o=0;o<i.length;++o)i[o](...n)}function g(e,...t){if(e)for(var n=0;n<e.length;++n)e[n](...t)}try{r=RegExp("[\\w\\p{Alphabetic}\\p{Number}_]","u")}catch(e){r=/[\w]/}function v(e,t){var n=e.cm6;if(!n.state.readOnly){var r="input.type.compose";if(e.curOp&&!e.curOp.lastChange&&(r="input.type.compose.start"),t.annotations)try{t.annotations.some(function(e){"input"==e.value&&(e.value=r)})}catch(e){console.error(e)}else t.userEvent=r;return n.dispatch(t)}}function y(e,t){var n;e.curOp&&(e.curOp.$changeStart=void 0),(t?c.Yw:c.KX)(e.cm6);let r=null===(n=e.curOp)||void 0===n?void 0:n.$changeStart;null!=r&&e.cm6.dispatch({selection:{anchor:r}})}class C{openDialog(e,t,n){return function(e,t,n,r){r||(r={}),w(e,void 0);var i=k(e,t,r.bottom),o=!1;function a(t){if("string"==typeof t)s.value=t;else{if(o)return;o=!0,S(e,i),e.state.dialog||e.focus(),r.onClose&&r.onClose(i)}}x(e,i);var s=i.getElementsByTagName("input")[0];return s&&(r.value&&(s.value=r.value,!1!==r.selectValueOnOpen&&s.select()),r.onInput&&C.on(s,"input",function(e){r.onInput(e,s.value,a)}),r.onKeyUp&&C.on(s,"keyup",function(e){r.onKeyUp(e,s.value,a)}),C.on(s,"keydown",function(e){r&&r.onKeyDown&&r.onKeyDown(e,s.value,a)||(13==e.keyCode&&n&&n(s.value),(27==e.keyCode||!1!==r.closeOnEnter&&13==e.keyCode)&&(s.blur(),C.e_stop(e),a()))}),!1!==r.closeOnBlur&&C.on(s,"blur",function(){setTimeout(function(){document.activeElement!==s&&a()})}),s.focus()),a}(this,e,t,n)}openNotification(e,t){return function(e,t,n){w(e,s);var r,i=k(e,t,n&&n.bottom),o=!1,a=n&&void 0!==n.duration?n.duration:5e3;function s(){o||(o=!0,clearTimeout(r),i.remove(),S(e,i))}return i.onclick=function(e){e.preventDefault(),s()},x(e,i),a&&(r=setTimeout(s,a)),s}(this,e,t)}constructor(e){this.state={},this.marks=Object.create(null),this.$mid=0,this.options={},this._handlers={},this.$lastChangeEndOffset=0,this.virtualSelection=null,this.cm6=e,this.onChange=this.onChange.bind(this),this.onSelectionChange=this.onSelectionChange.bind(this)}on(e,t){m(this,e,t)}off(e,t){p(this,e,t)}signal(e,t,n){f(this,e,t,n)}indexFromPos(e){return u(this.cm6.state.doc,e)}posFromIndex(e){return h(this.cm6.state.doc,e)}foldCode(e){let t=this.cm6,n=t.state.selection.ranges,r=u(this.cm6.state.doc,e),i=o.jT.create([o.jT.range(r,r)],0).ranges;t.state.selection.ranges=i,(0,a.wf)(t),t.state.selection.ranges=n}firstLine(){return 0}lastLine(){return this.cm6.state.doc.lines-1}lineCount(){return this.cm6.state.doc.lines}setCursor(e,t){"object"==typeof e&&(t=e.ch,e=e.line);var n=u(this.cm6.state.doc,{line:e,ch:t||0});this.cm6.dispatch({selection:{anchor:n}},{scrollIntoView:!this.curOp}),this.curOp&&!this.curOp.isVimOp&&this.onBeforeEndOperation()}getCursor(e){var t=this.cm6.state.selection.main,n="head"!=e&&e?"anchor"==e?t.anchor:"start"==e?t.from:"end"==e?t.to:null:t.head;if(null==n)throw Error("Invalid cursor type");return this.posFromIndex(n)}listSelections(){var e=this.cm6.state.doc;return this.cm6.state.selection.ranges.map(t=>({anchor:h(e,t.anchor),head:h(e,t.head)}))}setSelections(e,t){var n=this.cm6.state.doc,r=e.map(e=>{var t=u(n,e.head),r=u(n,e.anchor);return t==r?o.jT.cursor(t,1):o.jT.range(r,t)});this.cm6.dispatch({selection:o.jT.create(r,t)})}setSelection(e,t,n){this.setSelections([{anchor:e,head:t}],0),n&&"*mouse"==n.origin&&this.onBeforeEndOperation()}getLine(e){var t=this.cm6.state.doc;return e<0||e>=t.lines?"":this.cm6.state.doc.line(e+1).text}getLineHandle(e){return this.$lineHandleChanges||(this.$lineHandleChanges=[]),{row:e,index:this.indexFromPos(new d(e,0))}}getLineNumber(e){var t=this.$lineHandleChanges;if(!t)return null;for(var n=e.index,r=0;r<t.length;r++)if(null==(n=t[r].changes.mapPos(n,1,o.gc.TrackAfter)))return null;var i=this.posFromIndex(n);return 0==i.ch?i.line:null}releaseLineHandles(){this.$lineHandleChanges=void 0}getRange(e,t){var n=this.cm6.state.doc;return this.cm6.state.sliceDoc(u(n,e),u(n,t))}replaceRange(e,t,n,r){n||(n=t);var i=this.cm6.state.doc;v(this,{changes:{from:u(i,t),to:u(i,n),insert:e}})}replaceSelection(e){v(this,this.cm6.state.replaceSelection(e))}replaceSelections(e){v(this,{changes:this.cm6.state.selection.ranges.map((t,n)=>({from:t.from,to:t.to,insert:e[n]||""}))})}getSelection(){return this.getSelections().join("\n")}getSelections(){var e=this.cm6;return e.state.selection.ranges.map(t=>e.state.sliceDoc(t.from,t.to))}somethingSelected(){return this.cm6.state.selection.ranges.some(e=>!e.empty)}getInputField(){return this.cm6.contentDOM}clipPos(e){var t=this.cm6.state.doc,n=e.ch,r=e.line+1;r<1&&(r=1,n=0),r>t.lines&&(r=t.lines,n=Number.MAX_VALUE);var i=t.line(r);return new d(r-1,n=Math.min(Math.max(0,n),i.to-i.from))}getValue(){return this.cm6.state.doc.toString()}setValue(e){var t=this.cm6;return t.dispatch({changes:{from:0,to:t.state.doc.length,insert:e},selection:o.jT.range(0,0)})}focus(){return this.cm6.focus()}blur(){return this.cm6.contentDOM.blur()}defaultTextHeight(){return this.cm6.defaultLineHeight}findMatchingBracket(e,t){var n=this.cm6.state,r=u(n.doc,e),i=(0,a.Um)(n,r+1,-1);return i&&i.end||(i=(0,a.Um)(n,r,1))&&i.end?{to:h(n.doc,i.end.from)}:{to:void 0}}scanForBracket(e,t,n,r){return function(e,t,n,r,i){for(var o=i&&i.maxScanLineLength||1e4,a=i&&i.maxScanLines||1e3,s=[],l=i&&i.bracketRegex||/[(){}[\]]/,c=n>0?Math.min(t.line+a,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-a),u=t.line;u!=c;u+=n){var h=e.getLine(u);if(h){var m=n>0?0:h.length-1,p=n>0?h.length:-1;if(!(h.length>o))for(u==t.line&&(m=t.ch-(n<0?1:0));m!=p;m+=n){var f=h.charAt(m);if(l.test(f)){var g=M[f];if(g&&">"==g.charAt(1)==n>0)s.push(f);else{if(!s.length)return{pos:new d(u,m),ch:f};s.pop()}}}}}return u-n!=(n>0?e.lastLine():e.firstLine())&&null}(this,e,t,0,r)}indentLine(e,t){t?this.indentMore():this.indentLess()}indentMore(){(0,c.at)(this.cm6)}indentLess(){(0,c.xi)(this.cm6)}execCommand(e){if("indentAuto"==e)C.commands.indentAuto(this);else if("goLineLeft"==e)(0,c.Kd)(this.cm6);else if("goLineRight"==e){(0,c.Bx)(this.cm6);let e=this.cm6.state,t=e.selection.main.head;t<e.doc.length&&"\n"!==e.sliceDoc(t,t+1)&&(0,c.kU)(this.cm6)}else console.log(e+" is not implemented")}setBookmark(e,t){var n=(null==t?void 0:t.insertLeft)?1:-1;return new b(this,this.indexFromPos(e),n)}addOverlay({query:e}){let t=new l.Jb({regexp:!0,search:e.source,caseSensitive:!/i/.test(e.flags)});if(t.valid){t.forVim=!0,this.cm6Query=t;let e=l.ql.of(t);return this.cm6.dispatch({effects:e}),t}}removeOverlay(e){if(!this.cm6Query)return;this.cm6Query.forVim=!1;let t=l.ql.of(this.cm6Query);this.cm6.dispatch({effects:t})}getSearchCursor(e,t){var n=this,r=null,i=null,o=!1;void 0==t.ch&&(t.ch=Number.MAX_VALUE);var a=u(n.cm6.state.doc,t),s=e.source.replace(/(\\.|{(?:\d+(?:,\d*)?|,\d+)})|[{}]/g,function(e,t){return t||"\\"+e});function c(t,n=0,r=t.length){return new l.Zg(t,s,{ignoreCase:e.ignoreCase},n,r)}return{findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){var t=n.cm6.state.doc;return i=(r=e?function(e,t){var r=n.cm6.state.doc;for(let e=1;;e++){let n=Math.max(0,t-1e4*e),i=c(r,n,t),o=null;for(;!i.next().done;)o=i.value;if(o&&(0==n||o.from>n+10))return o;if(0==n)return null}}(0,r?o?r.to-1:r.from:a):function(e){var t=n.cm6.state.doc;if(e>t.length)return null;let r=c(t,e).next();return r.done?null:r.value}(r?o?r.to+1:r.to:a))&&{from:h(t,r.from),to:h(t,r.to),match:r.match},o=!!r&&r.from==r.to,r&&r.match},from:function(){return null==i?void 0:i.from},to:function(){return null==i?void 0:i.to},replace:function(e){r&&(v(n,{changes:{from:r.from,to:r.to,insert:e}}),r.to=r.from+e.length,i&&(i.to=h(n.cm6.state.doc,r.to)))},get match(){return i&&i.match}}}findPosV(e,t,n,r){let{cm6:i}=this,a=i.state.doc,s="page"==n?i.dom.clientHeight:0,l=u(a,e),c=o.jT.cursor(l,1,void 0,r),d=Math.round(Math.abs(t));for(let e=0;e<d;e++)"page"==n?c=i.moveVertically(c,t>0,s):"line"==n&&(c=i.moveVertically(c,t>0));let m=h(a,c.head);return(t<0&&0==c.head&&0!=r&&0==e.line&&0!=e.ch||t>0&&c.head==a.length&&m.ch!=r&&e.line==m.line)&&(m.hitSide=!0),m}charCoords(e,t){var n=this.cm6.contentDOM.getBoundingClientRect(),r=u(this.cm6.state.doc,e),i=this.cm6.coordsAtPos(r),o=-n.top;return{left:((null==i?void 0:i.left)||0)-n.left,top:((null==i?void 0:i.top)||0)+o,bottom:((null==i?void 0:i.bottom)||0)+o}}coordsChar(e,t){var n=this.cm6.contentDOM.getBoundingClientRect(),r=this.cm6.posAtCoords({x:e.left+n.left,y:e.top+n.top})||0;return h(this.cm6.state.doc,r)}getScrollInfo(){var e=this.cm6.scrollDOM;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight,width:e.scrollWidth,clientHeight:e.clientHeight,clientWidth:e.clientWidth}}scrollTo(e,t){null!=e&&(this.cm6.scrollDOM.scrollLeft=e),null!=t&&(this.cm6.scrollDOM.scrollTop=t)}scrollIntoView(e,t){if(e){var n=this.indexFromPos(e);this.cm6.dispatch({effects:s.tk.scrollIntoView(n)})}else this.cm6.dispatch({scrollIntoView:!0,userEvent:"scroll"})}getWrapperElement(){return this.cm6.dom}getMode(){return{name:this.getOption("mode")}}setSize(e,t){this.cm6.dom.style.width=e+4+"px",this.cm6.dom.style.height=t+"px",this.refresh()}refresh(){this.cm6.measure()}destroy(){this.removeOverlay()}getLastEditEnd(){return this.posFromIndex(this.$lastChangeEndOffset)}onChange(e){for(let t in this.$lineHandleChanges&&this.$lineHandleChanges.push(e),this.marks)this.marks[t].update(e.changes);this.virtualSelection&&(this.virtualSelection.ranges=this.virtualSelection.ranges.map(t=>t.map(e.changes)));var t=this.curOp=this.curOp||{};e.changes.iterChanges((e,n,r,i,o)=>{(null==t.$changeStart||t.$changeStart>r)&&(t.$changeStart=r),this.$lastChangeEndOffset=i;var a={text:o.toJSON()};t.lastChange?t.lastChange.next=t.lastChange=a:t.lastChange=t.change=a},!0),t.changeHandlers||(t.changeHandlers=this._handlers.change&&this._handlers.change.slice())}onSelectionChange(){var e=this.curOp=this.curOp||{};e.cursorActivityHandlers||(e.cursorActivityHandlers=this._handlers.cursorActivity&&this._handlers.cursorActivity.slice()),this.curOp.cursorActivity=!0}operation(e,t){this.curOp||(this.curOp={$d:0}),this.curOp.$d++;try{var n=e()}finally{this.curOp&&(this.curOp.$d--,this.curOp.$d||this.onBeforeEndOperation())}return n}onBeforeEndOperation(){var e=this.curOp,t=!1;e&&(e.change&&g(e.changeHandlers,this,e.change),e&&e.cursorActivity&&(g(e.cursorActivityHandlers,this,null),e.isVimOp&&(t=!0)),this.curOp=null),t&&this.scrollIntoView()}moveH(e,t){if("char"==t){var n=this.getCursor();this.setCursor(n.line,n.ch+e)}}setOption(e,t){switch(e){case"keyMap":this.state.keyMap=t;break;case"textwidth":this.state.textwidth=t}}getOption(e){switch(e){case"firstLineNumber":return 1;case"tabSize":return this.cm6.state.tabSize||4;case"readOnly":return this.cm6.state.readOnly;case"indentWithTabs":return"	"==this.cm6.state.facet(a.c);case"indentUnit":return this.cm6.state.facet(a.c).length||2;case"textwidth":return this.state.textwidth;case"keyMap":return this.state.keyMap||"vim"}}toggleOverwrite(e){this.state.overwrite=e}getTokenTypeAt(e){var t,n=this.indexFromPos(e),r=(0,a.l)(this.cm6.state,n),i=null==r?void 0:r.resolve(n),o=(null===(t=null==i?void 0:i.type)||void 0===t?void 0:t.name)||"";return/comment/i.test(o)?"comment":/string/i.test(o)?"string":""}overWriteSelection(e){var t=this.cm6.state.doc,n=this.cm6.state.selection,r=n.ranges.map(e=>{if(e.empty){var n=e.to<t.length?t.sliceString(e.from,e.to+1):"";if(n&&!/\n/.test(n))return o.jT.range(e.from,e.to+1)}return e});this.cm6.dispatch({selection:o.jT.create(r,n.mainIndex)}),this.replaceSelection(e)}isInMultiSelectMode(){return this.cm6.state.selection.ranges.length>1}virtualSelectionMode(){return!!this.virtualSelection}forEachSelection(e){var t=this.cm6.state.selection;this.virtualSelection=o.jT.create(t.ranges,t.mainIndex);for(var n=0;n<this.virtualSelection.ranges.length;n++){var r=this.virtualSelection.ranges[n];r&&(this.cm6.dispatch({selection:o.jT.create([r])}),e(),this.virtualSelection.ranges[n]=this.cm6.state.selection.ranges[0])}this.cm6.dispatch({selection:this.virtualSelection}),this.virtualSelection=null}hardWrap(e){return function(e,t){for(var n,r=t.column||e.getOption("textwidth")||80,i=!1!=t.allowMerge,o=Math.min(t.from,t.to),a=Math.max(t.from,t.to);o<=a;){var s=e.getLine(o);if(s.length>r){var l=f(s,r,5);if(l){var c=null===(n=/^\s*/.exec(s))||void 0===n?void 0:n[0];e.replaceRange("\n"+c,new d(o,l.start),new d(o,l.end))}a++}else if(i&&/\S/.test(s)&&o!=a){var u=e.getLine(o+1);if(u&&/\S/.test(u)){var h=s.replace(/\s+$/,""),m=u.replace(/^\s+/,""),p=h+" "+m,l=f(p,r,5);l&&l.start>h.length||p.length<r?(e.replaceRange(" ",new d(o,h.length),new d(o+1,u.length-m.length)),o--,a--):h.length<s.length&&e.replaceRange("",new d(o,h.length),new d(o,s.length))}}o++}return o;function f(e,t,n){if(!(e.length<t)){var r=e.slice(0,t),i=e.slice(t),o=/^(?:(\s+)|(\S+)(\s+))/.exec(i),a=/(?:(\s+)|(\s+)(\S+))$/.exec(r),s=0,l=0;if(a&&!a[2]&&(s=t-a[1].length,l=t),o&&!o[2]&&(s||(s=t),l=t+o[1].length),s)return{start:s,end:l};if(a&&a[2]&&a.index>n)return{start:a.index,end:a.index+a[2].length};if(o&&o[2])return{start:s=t+o[2].length,end:s+o[3].length}}}}(this,e)}}function k(e,t,n){var r=document.createElement("div");return r.appendChild(t),r}function w(e,t){e.state.currentNotificationClose&&e.state.currentNotificationClose(),e.state.currentNotificationClose=t}function x(e,t){var n=e.state.dialog;e.state.dialog=t,t.style.flex="1",t&&n!==t&&(n&&n.contains(document.activeElement)&&e.focus(),n&&n.parentElement?n.parentElement.replaceChild(t,n):n&&n.remove(),C.signal(e,"dialog"))}function S(e,t){e.state.dialog==t&&(e.state.dialog=null,C.signal(e,"dialog"))}C.isMac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),C.Pos=d,C.StringStream=a.gY,C.commands={cursorCharLeft:function(e){(0,c.lv)(e.cm6)},redo:function(e){y(e,!1)},undo:function(e){y(e,!0)},newlineAndIndent:function(e){(0,c.xx)({state:e.cm6.state,dispatch:t=>v(e,t)})},indentAuto:function(e){(0,c.wA)(e.cm6)},newlineAndIndentContinueComment:void 0,save:void 0},C.isWordChar=function(e){return r.test(e)},C.keys={Left:e=>(0,s.$1)(e.cm6,{key:"Left"},"editor"),Right:e=>(0,s.$1)(e.cm6,{key:"Right"},"editor"),Up:e=>(0,s.$1)(e.cm6,{key:"Up"},"editor"),Down:e=>(0,s.$1)(e.cm6,{key:"Down"},"editor"),Backspace:e=>(0,s.$1)(e.cm6,{key:"Backspace"},"editor"),Delete:e=>(0,s.$1)(e.cm6,{key:"Delete"},"editor")},C.addClass=function(e,t){},C.rmClass=function(e,t){},C.e_preventDefault=function(e){e.preventDefault()},C.e_stop=function(e){var t,n;null===(t=null==e?void 0:e.stopPropagation)||void 0===t||t.call(e),null===(n=null==e?void 0:e.preventDefault)||void 0===n||n.call(e)},C.lookupKey=function(e,t,n){var r=C.keys[e];!r&&/^Arrow/.test(e)&&(r=C.keys[e.slice(5)]),r&&n(r)},C.on=m,C.off=p,C.signal=f,C.findMatchingTag=function(e,t){return null},C.findEnclosingTag=function(e,t){var n,r,i=e.cm6.state,o=e.indexFromPos(t);o<i.doc.length&&"<"==i.sliceDoc(o,o+1)&&o++;for(var s=(0,a.l)(i,o),l=(null==s?void 0:s.resolve(o))||null;l;){if((null===(n=l.firstChild)||void 0===n?void 0:n.type.name)=="OpenTag"&&(null===(r=l.lastChild)||void 0===r?void 0:r.type.name)=="CloseTag")return{open:L(i.doc,l.firstChild),close:L(i.doc,l.lastChild)};l=l.parent}},C.keyName=void 0;var M={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function L(e,t){return{from:h(e,t.from),to:h(e,t.to)}}class b{constructor(e,t,n){this.cm=e,this.id=e.$mid++,this.offset=t,this.assoc=n,e.marks[this.id]=this}clear(){delete this.cm.marks[this.id]}find(){return null==this.offset?null:this.cm.posFromIndex(this.offset)}update(e){null!=this.offset&&(this.offset=e.mapPos(this.offset,this.assoc,o.gc.TrackDel))}}let A=s.HM||(i={cursorBlinkRate:1200},function(){return i});class E{constructor(e,t,n,r,i,o,a,s,l,c){this.left=e,this.top=t,this.height=n,this.fontFamily=r,this.fontSize=i,this.fontWeight=o,this.color=a,this.className=s,this.letter=l,this.partial=c}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.height=this.height+"px",e.style.lineHeight=this.height+"px",e.style.fontFamily=this.fontFamily,e.style.fontSize=this.fontSize,e.style.fontWeight=this.fontWeight,e.style.color=this.partial?"transparent":this.color,e.className=this.className,e.textContent=this.letter}eq(e){return this.left==e.left&&this.top==e.top&&this.height==e.height&&this.fontFamily==e.fontFamily&&this.fontSize==e.fontSize&&this.fontWeight==e.fontWeight&&this.color==e.color&&this.className==e.className&&this.letter==e.letter}}class O{constructor(e,t){this.view=e,this.rangePieces=[],this.cursors=[],this.cm=t,this.measureReq={read:this.readPos.bind(this),write:this.drawSel.bind(this)},this.cursorLayer=e.scrollDOM.appendChild(document.createElement("div")),this.cursorLayer.className="cm-cursorLayer cm-vimCursorLayer",this.cursorLayer.setAttribute("aria-hidden","true"),e.requestMeasure(this.measureReq),this.setBlinkRate()}setBlinkRate(){let e=A(this.cm.cm6.state).cursorBlinkRate;this.cursorLayer.style.animationDuration=e+"ms"}update(e){(e.selectionSet||e.geometryChanged||e.viewportChanged)&&(this.view.requestMeasure(this.measureReq),this.cursorLayer.style.animationName="cm-blink"==this.cursorLayer.style.animationName?"cm-blink2":"cm-blink"),A(e.startState)!=A(e.state)&&this.setBlinkRate()}scheduleRedraw(){this.view.requestMeasure(this.measureReq)}readPos(){let{state:e}=this.view,t=[];for(let n of e.selection.ranges){let r=n==e.selection.main,i=function(e,t,n,r){var i,o,a;let l=n.head,c=!1,u=1,h=e.state.vim;if(h&&(!h.insertMode||e.state.overwrite)){if(c=!0,h.visualBlock&&!r)return null;n.anchor<n.head&&"\n"!=(l<t.state.doc.length&&t.state.sliceDoc(l,l+1))&&l--,e.state.overwrite?u=.2:h.status&&(u=.5)}if(!c)return null;{let e,n=l<t.state.doc.length&&t.state.sliceDoc(l,l+1);n&&/[\uDC00-\uDFFF]/.test(n)&&l>1&&(l--,n=t.state.sliceDoc(l,l+1));let c=t.coordsAtPos(l,1);if(!c)return null;let h=(e=t.scrollDOM.getBoundingClientRect(),{left:(t.textDirection==s.Nm.LTR?e.left:e.right-t.scrollDOM.clientWidth)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}),m=t.domAtPos(l),p=m?m.node:t.contentDOM;for(p instanceof Text&&m.offset>=p.data.length&&(null===(i=p.parentElement)||void 0===i?void 0:i.nextSibling)&&(m={node:p=null===(o=p.parentElement)||void 0===o?void 0:o.nextSibling,offset:0});m&&m.node instanceof HTMLElement;)p=m.node,m={node:m.node.childNodes[m.offset],offset:0};if(!(p instanceof HTMLElement)){if(!p.parentNode)return null;p=p.parentNode}let f=getComputedStyle(p),g=c.left,v=null===(a=t.coordsForChar)||void 0===a?void 0:a.call(t,l);if(v&&(g=v.left),n&&"\n"!=n&&"\r"!=n){if("	"==n){n="\xa0";var d=t.coordsAtPos(l+1,-1);d&&(g=d.left-(d.left-c.left)/parseInt(f.tabSize))}else/[\uD800-\uDBFF]/.test(n)&&l<t.state.doc.length-1&&(n+=t.state.sliceDoc(l+1,l+2))}else n="\xa0";let y=c.bottom-c.top;return new E((g-h.left)/t.scaleX,(c.top-h.top+y*(1-u))/t.scaleY,y*u/t.scaleY,f.fontFamily,f.fontSize,f.fontWeight,f.color,r?"cm-fat-cursor cm-cursor-primary":"cm-fat-cursor cm-cursor-secondary",n,1!=u)}}(this.cm,this.view,n,r);i&&t.push(i)}return{cursors:t}}drawSel({cursors:e}){if(e.length!=this.cursors.length||e.some((e,t)=>!e.eq(this.cursors[t]))){let t=this.cursorLayer.children;if(t.length!==e.length)for(let t of(this.cursorLayer.textContent="",e))this.cursorLayer.appendChild(t.draw());else e.forEach((e,n)=>e.adjust(t[n]));this.cursors=e}}destroy(){this.cursorLayer.remove()}}let T=o.Wl.highest(s.tk.theme({".cm-vimMode .cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-fat-cursor":{position:"absolute",background:"#ff9696",border:"none",whiteSpace:"pre"},"&:not(.cm-focused) .cm-fat-cursor":{background:"none",outline:"solid 1px #ff9696",color:"transparent !important"}}));var R="undefined"!=typeof navigator&&/linux/i.test(navigator.platform)&&/ Gecko\/\d+/.exec(navigator.userAgent);let N=function(e){var t,n,r,i=e.Pos;function o(e,t,n){if(t.line===n.line&&t.ch>=n.ch-1){var r=e.getLine(t.line).charCodeAt(t.ch);55296<=r&&r<=55551&&(n.ch+=1)}return{start:t,end:n}}var a=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"g<Up>",type:"keyToKey",toKeys:"gk"},{keys:"g<Down>",type:"keyToKey",toKeys:"gj"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<Del>",type:"keyToKey",toKeys:"x"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-Esc>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"keyToKey",toKeys:"i",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"g$",type:"motion",motion:"moveToEndOfDisplayLine"},{keys:"g^",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"g0",type:"motion",motion:"moveToStartOfDisplayLine"},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<register>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"gn",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!0}},{keys:"gN",type:"motion",motion:"findAndSelectNextInclusive",motionArgs:{forward:!1}},{keys:"gq",type:"operator",operator:"hardWrap"},{keys:"gw",type:"operator",operator:"hardWrap",operatorArgs:{keepCursor:!0}},{keys:"g?",type:"operator",operator:"rot13"},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-u>",type:"operatorMotion",operator:"delete",motion:"moveToStartOfLine",context:"insert"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"gi",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"lastEdit"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"gI",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"bol"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"gJ",type:"action",action:"joinLines",actionArgs:{keepSpaces:!0},isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<register>",type:"action",action:"replayMacro"},{keys:"q<register>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0},context:"normal"},{keys:"R",type:"operator",operator:"change",operatorArgs:{linewise:!0,fullLine:!0},context:"visual",exitVisualBlock:!0},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<register>",type:"action",action:"setMark"},{keys:'"<register>',type:"action",action:"setRegister"},{keys:"<C-r><register>",type:"action",action:"insertRegister",context:"insert",isEdit:!0},{keys:"<C-o>",type:"action",action:"oneNormalCommand",context:"insert"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<register>",type:"motion",motion:"textObjectManipulation"},{keys:"i<register>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],s=Object.create(null),l=a.length,c=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"omap",shortName:"om"},{name:"noremap",shortName:"no"},{name:"nnoremap",shortName:"nn"},{name:"vnoremap",shortName:"vn"},{name:"inoremap",shortName:"ino"},{name:"onoremap",shortName:"ono"},{name:"unmap"},{name:"mapclear",shortName:"mapc"},{name:"nmapclear",shortName:"nmapc"},{name:"vmapclear",shortName:"vmapc"},{name:"imapclear",shortName:"imapc"},{name:"omapclear",shortName:"omapc"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"startinsert",shortName:"start"},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"marks",excludeFromCommandHistory:!0},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"vglobal",shortName:"v"},{name:"delete",shortName:"d"},{name:"join",shortName:"j"},{name:"normal",shortName:"norm"},{name:"global",shortName:"g"}],u=$("");function h(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(er(e.getCursor(),0,1)),ee.enterInsertMode(e,{},t))}),t.onPasteFn}var d=/[\d]/,m=[e.isWordChar,function(t){return t&&!e.isWordChar(t)&&!/\s/.test(t)}],p=[function(e){return/\S/.test(e)}],f=["<",">"],g=["-",'"',".",":","_","/","+"],v=/^\w$/,y=/^[A-Z]$/;try{y=RegExp("^[\\p{Lu}]$","u")}catch(e){}function C(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function k(e){return/^[a-z]$/.test(e)}function w(e){return/^\s*$/.test(e)}function x(e){return -1!=".?!".indexOf(e)}function S(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}var M={};function L(e,t,n,r,i){if(void 0===t&&!i)throw Error("defaultValue is required unless callback is provided");if(n||(n="string"),M[e]={type:n,defaultValue:t,callback:i},r)for(var o=0;o<r.length;o++)M[r[o]]=M[e];t&&b(e,t)}function b(e,t,n,r){var i=M[e],o=(r=r||{}).scope;if(!i)return Error("Unknown option: "+e);if("boolean"==i.type){if(t&&!0!==t)return Error("Invalid argument: "+e+"="+t);!1!==t&&(t=!0)}i.callback?("local"!==o&&i.callback(t,void 0),"global"!==o&&n&&i.callback(t,n)):("local"!==o&&(i.value="boolean"==i.type?!!t:t),"global"!==o&&n&&(n.state.vim.options[e]={value:t}))}function A(e,t,n){var r=M[e],i=(n=n||{}).scope;if(!r)return Error("Unknown option: "+e);if(!r.callback)return("global"!==i&&t&&t.state.vim.options[e]||"local"!==i&&r||{}).value;{let e=t&&r.callback(void 0,t);return"global"!==i&&void 0!==e?e:"local"!==i?r.callback():void 0}}L("filetype",void 0,"string",["ft"],function(e,t){if(void 0!==t){if(void 0===e){let e=t.getOption("mode");return"null"==e?"":e}t.setOption("mode",""==e?"null":e)}}),L("textwidth",80,"number",["tw"],function(e,t){if(void 0!==t){if(void 0===e)return t.getOption("textwidth");var n=Math.round(e);n>1&&t.setOption("textwidth",n)}});var E=function(){var e=-1,t=0,n=0,r=Array(100);function i(i,o){(e+=o)>t?e=t:e<n&&(e=n);var a=r[(100+e)%100];if(a&&!a.find()){var s,l=o>0?1:-1,c=i.getCursor();do if(e+=l,(a=r[(100+e)%100])&&(s=a.find())&&!ea(c,s))break;while(e<t&&e>n)}return a}return{cachedCursor:void 0,add:function(i,o,a){var s=r[e%100];function l(t){var n=++e%100,o=r[n];o&&o.clear(),r[n]=i.setBookmark(t)}if(s){var c=s.find();c&&!ea(c,o)&&l(o)}else l(o);l(a),t=e,(n=e-100+1)<0&&(n=0)},find:function(t,n){var r=e,o=i(t,n);return e=r,o&&o.find()},move:i}},O=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};class T{constructor(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=O()}exitMacroRecordMode(){var e=t.macroModeState;e.onRecordingDone&&e.onRecordingDone(),e.onRecordingDone=void 0,e.isRecording=!1}enterMacroRecordMode(e,n){var r=t.registerController.getRegister(n);if(r){if(r.clear(),this.latestRegister=n,e.openDialog){var i=ej("span",{class:"cm-vim-message"},"recording @"+n);this.onRecordingDone=e.openDialog(i,function(){},{bottom:!0})}this.isRecording=!0}}}function R(e){return e.state.vim||(e.state.vim={inputState:new W,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeReturn:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:void 0,sel:{anchor:new i(0,0),head:new i(0,0)},options:{},expectLiteralNext:!1,status:""}),e.state.vim}function N(){for(var e in t={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:E(),macroModeState:new T,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new J({}),searchHistoryController:new z,exCommandHistoryController:new z},M){var n=M[e];n.value=n.defaultValue}}class B{constructor(e,t){this.keyName=e,this.key=t.key,this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.shiftKey=t.shiftKey}}var I={enterVimMode:function(t){t.setOption("disableInput",!0),t.setOption("showCursorWhenSelecting",!1),e.signal(t,"vim-mode-change",{mode:"normal"}),t.on("cursorActivity",e6),R(t),e.on(t.getInputField(),"paste",h(t))},leaveVimMode:function(t){t.setOption("disableInput",!1),t.off("cursorActivity",e6),e.off(t.getInputField(),"paste",h(t)),t.state.vim=null,e$&&clearTimeout(e$)},buildKeyMap:function(){},getRegisterController:function(){return t.registerController},resetVimGlobalState_:N,getVimGlobalState_:function(){return t},maybeInitVimState_:R,suppressErrorLogging:!1,InsertModeKey:B,map:function(e,t,n){eG.map(e,t,n)},unmap:function(e,t){return eG.unmap(e,t)},noremap:function(e,t,n){eG.map(e,t,n,!0)},mapclear:function(e){var t=a.length,n=a.slice(0,t-l);if(a=a.slice(t-l),e)for(var r=n.length-1;r>=0;r--){var i=n[r];if(e!==i.context){if(i.context)this._mapCommand(i);else{var o=["normal","insert","visual"];for(var s in o)if(o[s]!==e){var c=Object.assign({},i);c.context=o[s],this._mapCommand(c)}}}}},langmap:_,vimKeyFromEvent:V,setOption:b,getOption:A,defineOption:L,defineEx:function(e,t,n){if(t){if(0!==e.indexOf(t))throw Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered')}else t=e;eY[e]=n,eG.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(e,t,n){var r=this.findKey(e,t,n);if("function"==typeof r)return r()},multiSelectHandleKey:function(e,t,n){var r=R(e),i=!1,r=I.maybeInitVimState_(e),o=r.visualBlock||r.wasInVisualBlock;if(e.state.closeVimNotification){var a=e.state.closeVimNotification;if(e.state.closeVimNotification=null,a(),"<CR>"==t)return U(e),!0}var s=e.isInMultiSelectMode();if(r.wasInVisualBlock&&!s?r.wasInVisualBlock=!1:s&&r.visualBlock&&(r.wasInVisualBlock=!0),"<Esc>"!=t||r.insertMode||r.visualMode||!s||"<Esc>"!=r.status){if(o||!s||e.inVirtualSelectionMode)i=I.handleKey(e,t,n);else{var l=e4(r),c=r.inputState.changeQueueList||[];e.operation(function(){e.curOp&&(e.curOp.isVimOp=!0);var o=0;e.forEachSelection(function(){e.state.vim.inputState.changeQueue=c[o];var r=e.getCursor("head"),a=e.getCursor("anchor"),s=es(r,a)?0:-1,u=es(r,a)?-1:0;r=er(r,0,s),a=er(a,0,u),e.state.vim.sel.head=r,e.state.vim.sel.anchor=a,i=I.handleKey(e,t,n),e.virtualSelection&&(c[o]=e.state.vim.inputState.changeQueue,e.state.vim=e4(l)),o++}),e.curOp?.cursorActivity&&!i&&(e.curOp.cursorActivity=!1),e.state.vim=r,r.inputState.changeQueueList=c,r.inputState.changeQueue=null},!0)}}else U(e);return!i||r.visualMode||r.insertMode||r.visualMode==e.somethingSelected()||e2(e,r),i},findKey:function(r,i,o){var s=R(r);function l(){if("<Esc>"==i){if(s.visualMode)ey(r);else{if(!s.insertMode)return;eZ(r)}return U(r),!0}}var c=s.insertMode?function(){if(l())return!0;s.inputState.keyBuffer.push(i);var e=s.inputState.keyBuffer.join(""),o=1==i.length,c=X.matchCommand(e,a,s.inputState,"insert"),u=s.inputState.changeQueue;if("none"==c.type)return U(r),!1;if("partial"==c.type){if(c.expectLiteralNext&&(s.expectLiteralNext=!0),n&&window.clearTimeout(n),n=o&&window.setTimeout(function(){s.insertMode&&s.inputState.keyBuffer.length&&U(r)},A("insertModeEscKeysTimeout")),o){var h=r.listSelections();u&&u.removed.length==h.length||(u=s.inputState.changeQueue=new q),u.inserted+=i;for(var d=0;d<h.length;d++){var m=el(h[d].anchor,h[d].head),p=ec(h[d].anchor,h[d].head),f=r.getRange(m,r.state.overwrite?er(p,0,1):p);u.removed[d]=(u.removed[d]||"")+f}}return!o}if("full"==c.type&&(s.inputState.keyBuffer.length=0),s.expectLiteralNext=!1,n&&window.clearTimeout(n),c.command&&u){for(var h=r.listSelections(),d=0;d<h.length;d++){var g=h[d].head;r.replaceRange(u.removed[d]||"",er(g,0,-u.inserted.length),g,"+input")}t.macroModeState.lastInsertModeChanges.changes.pop()}return c.command||U(r),c.command}():function(){if(function(){var e=t.macroModeState;if(e.isRecording){if("q"==i)return e.exitMacroRecordMode(),U(r),!0;"mapping"!=o&&function(e,n){if(!e.isPlaying){var r=e.latestRegister,i=t.registerController.getRegister(r);i&&i.pushText(n)}}(e,i)}}()||l())return!0;s.inputState.keyBuffer.push(i);var e=s.inputState.keyBuffer.join("");if(/^[1-9]\d*$/.test(e))return!0;var n=/^(\d*)(.*)$/.exec(e);if(!n)return U(r),!1;var c=s.visualMode?"visual":"normal",u=n[2]||n[1];s.inputState.operatorShortcut&&s.inputState.operatorShortcut.slice(-1)==u&&(u=s.inputState.operatorShortcut);var h=X.matchCommand(u,a,s.inputState,c);return"none"==h.type?(U(r),!1):"partial"==h.type?(h.expectLiteralNext&&(s.expectLiteralNext=!0),!0):"clear"==h.type?(U(r),!0):(s.expectLiteralNext=!1,s.inputState.keyBuffer.length=0,(n=/^(\d*)(.*)$/.exec(e))&&n[1]&&"0"!=n[1]&&s.inputState.pushRepeatDigit(n[1]),h.command)}();return!1===c?!s.insertMode&&(1===i.length||e.isMac&&/<A-.>/.test(i))?function(){return!0}:void 0:!0===c?function(){return!0}:c?function(){return r.operation(function(){r.curOp.isVimOp=!0;try{if("object"!=typeof c)return;"keyToKey"==c.type?P(r,c.toKeys,c):X.processCommand(r,s,c)}catch(e){throw r.state.vim=void 0,R(r),I.suppressErrorLogging||console.log(e),e}return!0})}:void 0},handleEx:function(e,t){eG.processCommand(e,t)},defineMotion:function(e,t){Y[e]=t},defineAction:function(e,t){ee[e]=t},defineOperator:function(e,t){Z[e]=t},mapCommand:function(e,t,n,r,i){var o={keys:e,type:t};for(var a in o[t]=n,o[t+"Args"]=r,i)o[a]=i[a];e0(o)},_mapCommand:e0,defineRegister:function(e,n){var r=t.registerController.registers;if(!e||1!=e.length)throw Error("Register name must be 1 character");if(r[e])throw Error("Register already defined "+e);r[e]=n,g.push(e)},exitVisualMode:ey,exitInsertMode:eZ},K=[],D=!1;function P(e,t,n){var i=D;if(n){if(-1!=K.indexOf(n))return;K.push(n),D=!1!=n.noremap}try{for(var o,a=R(e),s=/<(?:[CSMA]-)*\w+>|./gi;o=s.exec(t);){var l=o[0],c=a.insertMode;if(r){!function(e){if(!r)throw Error("No prompt to send key to");if("<"==e[0]){var t=e.toLowerCase().slice(1,-1);if("lt"==(t=t.split("-").pop()||""))e="<";else if("space"==t)e=" ";else if("cr"==t)e="\n";else if(F[t]){var n=r.value||"",i={key:F[t],target:{value:n,selectionEnd:n.length,selectionStart:n.length}};r.onKeyDown&&r.onKeyDown(i,r.value,a),r&&r.onKeyUp&&r.onKeyUp(i,r.value,a);return}}if("\n"==e){var o=r;r=null,o.onClose&&o.onClose(o.value)}else r.value=(r.value||"")+e;function a(e){r&&("string"==typeof e?r.value=e:r=null)}}(l);continue}if(!I.handleKey(e,l,"mapping")&&c&&a.insertMode){if("<"==l[0]){var u=l.toLowerCase().slice(1,-1);if(u=u.split("-").pop()||"","lt"==u)l="<";else if("space"==u)l=" ";else if("cr"==u)l="\n";else if(F.hasOwnProperty(u)){l=F[u],e8(e,l);continue}else l=l[0],s.lastIndex=o.index+1}e.replaceSelection(l)}}}finally{if(K.pop(),D=!!K.length&&i,!K.length&&r){var h=r;r=null,eV(e,h)}}}var H={Return:"CR",Backspace:"BS",Delete:"Del",Escape:"Esc",Insert:"Ins",ArrowLeft:"Left",ArrowRight:"Right",ArrowUp:"Up",ArrowDown:"Down",Enter:"CR"," ":"Space"},j={Shift:1,Alt:1,Command:1,Control:1,CapsLock:1,AltGraph:1,Dead:1,Unidentified:1},F={};function V(t,n){var r=t.key;if(!j[r]){r.length>1&&"n"==r[0]&&(r=r.replace("Numpad","")),r=H[r]||r;var i="";if(t.ctrlKey&&(i+="C-"),t.altKey&&(i+="A-"),t.metaKey&&(i+="M-"),e.isMac&&"A-"==i&&1==r.length&&(i=i.slice(2)),(i||r.length>1)&&t.shiftKey&&(i+="S-"),n&&!n.expectLiteralNext&&1==r.length){if(u.keymap&&r in u.keymap)!1==u.remapCtrl&&i||(r=u.keymap[r]);else if(r.charCodeAt(0)>128&&!s[r]){var o=t.code?.slice(-1)||"";t.shiftKey||(o=o.toLowerCase()),o&&(r=o,!i&&t.altKey&&(i="A-"))}}return(i+=r).length>1&&(i="<"+i+">"),i}}function _(e,t){u.string!==e&&(u=$(e)),u.remapCtrl=t}function $(e){let t={};if(!e)return{keymap:t,string:""};function n(e){return e.split(/\\?(.)/).filter(Boolean)}return e.split(/((?:[^\\,]|\\.)+),/).map(e=>{if(!e)return;let r=e.split(/((?:[^\\;]|\\.)+);/);if(3==r.length){let e=n(r[1]),i=n(r[2]);if(e.length!==i.length)return;for(let n=0;n<e.length;++n)t[e[n]]=i[n]}else if(1==r.length){let r=n(e);if(r.length%2!=0)return;for(let e=0;e<r.length;e+=2)t[r[e]]=r[e+1]}}),{keymap:t,string:e}}"Left|Right|Up|Down|End|Home".split("|").concat(Object.keys(H)).forEach(function(e){F[(H[e]||"").toLowerCase()]=F[e.toLowerCase()]=e}),L("langmap",void 0,"string",["lmap"],function(e,t){if(void 0===e)return u.string;_(e)});class W{constructor(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=void 0,this.changeQueue=null}pushRepeatDigit(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)}getRepeat(){var e=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(e=1,this.prefixRepeat.length>0&&(e*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(e*=parseInt(this.motionRepeat.join(""),10))),e}}function U(t,n){t.state.vim.inputState=new W,t.state.vim.expectLiteralNext=!1,e.signal(t,"vim-command-done",n)}function q(){this.removed=[],this.inserted=""}class Q{constructor(e,t,n){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t,this.blockwise=!!n}setText(e,t,n){this.keyBuffer=[e||""],this.linewise=!!t,this.blockwise=!!n}pushText(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)}pushInsertModeChanges(e){this.insertModeChanges.push(O(e))}pushSearchQuery(e){this.searchQueries.push(e)}clear(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1}toString(){return this.keyBuffer.join("")}}class J{constructor(e){this.registers=e,this.unnamedRegister=e['"']=new Q,e["."]=new Q,e[":"]=new Q,e["/"]=new Q,e["+"]=new Q}pushText(e,t,n,r,i){if("_"!==e){r&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var o=this.isValidRegister(e)?this.getRegister(e):null;if(!o||!e){switch(t){case"yank":this.registers["0"]=new Q(n,r,i);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new Q(n,r):(this.shiftNumericRegisters_(),this.registers["1"]=new Q(n,r))}this.unnamedRegister.setText(n,r,i);return}y.test(e)?o.pushText(n,r):o.setText(n,r,i),"+"===e&&navigator.clipboard.writeText(n),this.unnamedRegister.setText(o.toString(),r)}}getRegister(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new Q),this.registers[e]):this.unnamedRegister}isValidRegister(e){return e&&(S(e,g)||v.test(e))}shiftNumericRegisters_(){for(var e=9;e>=2;e--)this.registers[e]=this.getRegister(""+(e-1))}}class z{constructor(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}nextMatch(e,t){var n=this.historyBuffer,r=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var i=this.iterator+r;t?i>=0:i<n.length;i+=r)for(var o=n[i],a=0;a<=o.length;a++)if(this.initialPrefix==o.substring(0,a))return this.iterator=i,o;return i>=n.length?(this.iterator=n.length,this.initialPrefix):i<0?e:void 0}pushInput(e){var t=this.historyBuffer.indexOf(e);t>-1&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)}reset(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}}var X={matchCommand:function(e,t,n,r){var i=function(e,t,n,r){r.operator&&(n="operatorPending");for(var i,o=[],a=[],s=D?t.length-l:0,c=s;c<t.length;c++){var u=t[c];("insert"!=n||"insert"==u.context)&&(!u.context||u.context==n)&&(!r.operator||"action"!=u.type)&&(i=function(e,t){let n="<character>"==t.slice(-11),r="<register>"==t.slice(-10);if(!n&&!r)return e==t?"full":0==t.indexOf(e)&&"partial";var i=t.length-(n?11:10),o=e.slice(0,i),a=t.slice(0,i);return o==a&&e.length>i?"full":0==a.indexOf(o)&&"partial"}(e,u.keys))&&("partial"==i&&o.push(u),"full"==i&&a.push(u))}return{partial:o,full:a}}(e,t,r,n),o=i.full[0];if(!o)return i.partial.length?{type:"partial",expectLiteralNext:1==i.partial.length&&"<character>"==i.partial[0].keys.slice(-11)}:{type:"none"};if("<character>"==o.keys.slice(-11)||"<register>"==o.keys.slice(-10)){var a=function(e){var t=/^.*(<[^>]+>)$/.exec(e),n=t?t[1]:e.slice(-1);if(n.length>1)switch(n){case"<CR>":case"<S-CR>":n="\n";break;case"<Space>":case"<S-Space>":n=" ";break;default:n=""}return n}(e);if(!a||a.length>1)return{type:"clear"};n.selectedCharacter=a}return{type:"full",command:o}},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=en(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var r=t.inputState;if(r.operator){if(r.operator==n.operator){r.motion="expandToLine",r.motionArgs={linewise:!0,repeat:1},this.evalInput(e,t);return}U(e)}r.operator=n.operator,r.operatorArgs=en(n.operatorArgs),n.keys.length>1&&(r.operatorShortcut=n.keys),n.exitVisualBlock&&(t.visualBlock=!1,eg(e)),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var r=t.visualMode,i=en(n.operatorMotionArgs);i&&r&&i.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),r||this.processMotion(e,t,n)},processAction:function(e,t,n){var r=t.inputState,i=r.getRepeat(),o=!!i,a=en(n.actionArgs)||{repeat:1};r.selectedCharacter&&(a.selectedCharacter=r.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),a.repeat=i||1,a.repeatIsExplicit=o,a.registerName=r.registerName,U(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,r,n),ee[n.action](e,a,t)},processSearch:function(n,r,i){if(n.getSearchCursor){var o=i.searchArgs.forward,a=i.searchArgs.wholeWordOnly;eB(n).setReversed(!o);var s=eB(n).getQuery(),l=n.getScrollInfo(),c="";switch(i.searchArgs.querySrc){case"prompt":var u=t.macroModeState;u.isPlaying?m(u.replaySearchQueries.shift()||"",!0,!1):eV(n,{onClose:function(e){n.scrollTo(l.left,l.top),m(e,!0,!0);var r=t.macroModeState;r.isRecording&&function(e,n){if(!e.isPlaying){var r=e.latestRegister,i=t.registerController.getRegister(r);i&&i.pushSearchQuery&&i.pushSearchQuery(n)}}(r,e)},prefix:o?"/":"?",desc:ej("span",{$cursor:"pointer",onmousedown:function(e){e.preventDefault(),b("pcre",!A("pcre")),this.textContent=p(),f()}},p()),onKeyUp:function(e,n,r){var i,o,a=V(e);"<Up>"==a||"<Down>"==a?(i="<Up>"==a,o=e.target?e.target.selectionEnd:0,r(n=t.searchHistoryController.nextMatch(n,i)||""),o&&e.target&&(e.target.selectionEnd=e.target.selectionStart=Math.min(o,e.target.value.length))):a&&"<Left>"!=a&&"<Right>"!=a&&t.searchHistoryController.reset(),c=n,f()},onKeyDown:function(r,i,o){var a=V(r);"<Esc>"==a||"<C-c>"==a||"<C-[>"==a||"<BS>"==a&&""==i?(t.searchHistoryController.pushInput(i),t.searchHistoryController.reset(),e_(n,s?.source||""),eq(n),n.scrollTo(l.left,l.top),e.e_stop(r),U(n),o(),n.focus()):"<Up>"==a||"<Down>"==a?e.e_stop(r):"<C-u>"==a&&(e.e_stop(r),o(""))}});break;case"wordUnderCursor":var h=ek(n,{noSymbol:!0}),d=!0;if(h||(h=ek(n,{noSymbol:!1}),d=!1),!h){eF(n,"No word under cursor"),U(n);return}let r=n.getLine(h.start.line).substring(h.start.ch,h.end.ch);r=d&&a?"\\b"+r+"\\b":r.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1"),t.jumpList.cachedCursor=n.getCursor(),n.setCursor(h.start),m(r,!0,!1)}}function m(e,o,a){t.searchHistoryController.pushInput(e),t.searchHistoryController.reset();try{e_(n,e,o,a)}catch(t){eF(n,"Invalid regex: "+e),U(n);return}X.processMotion(n,r,{keys:"",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:i.searchArgs.toJumplist}})}function p(){return A("pcre")?"(JavaScript regexp: set pcre)":"(Vim regexp: set nopcre)"}function f(){var e;try{e=e_(n,c,!0,!0)}catch(e){}e?n.scrollIntoView(eU(n,!o,e),30):(eq(n),n.scrollTo(l.left,l.top))}},processEx:function(n,r,i){if("keyToEx"==i.type)eG.processCommand(n,i.exArgs.input);else{var o={onClose:function(e){t.exCommandHistoryController.pushInput(e),t.exCommandHistoryController.reset(),eG.processCommand(n,e),n.state.vim&&U(n),eq(n)},onKeyDown:function(r,i,o){var a,s,l=V(r);("<Esc>"==l||"<C-c>"==l||"<C-[>"==l||"<BS>"==l&&""==i)&&(t.exCommandHistoryController.pushInput(i),t.exCommandHistoryController.reset(),e.e_stop(r),U(n),eq(n),o(),n.focus()),"<Up>"==l||"<Down>"==l?(e.e_stop(r),a="<Up>"==l,s=r.target?r.target.selectionEnd:0,o(i=t.exCommandHistoryController.nextMatch(i,a)||""),s&&r.target&&(r.target.selectionEnd=r.target.selectionStart=Math.min(s,r.target.value.length))):"<C-u>"==l?(e.e_stop(r),o("")):l&&"<Left>"!=l&&"<Right>"!=l&&t.exCommandHistoryController.reset()},onKeyUp:function(t,r){var i=new e.StringStream(r),o={};try{if(eG.parseInput_(n,i,o),"s"!=o.commandName){eq(n);return}var a=eG.matchCommand_(o.commandName);if(!a||(eG.parseCommandArgs_(i,o,a),!o.argString))return;var s=eH(o.argString.slice(1),!0,!0);s&&eW(n,s)}catch(e){}},prefix:":"};r.visualMode&&(o.value="'<,'>",o.selectValueOnOpen=!1),eV(n,o)}},evalInput:function(e,n){var r=n.inputState,a=r.motion,s=r.motionArgs||{repeat:1},l=r.operator,c=r.operatorArgs||{},u=r.registerName,h=n.sel,d=eo(n.visualMode?et(e,h.head):e.getCursor("head")),m=eo(n.visualMode?et(e,h.anchor):e.getCursor("anchor")),p=eo(d),f=eo(m);if(l&&this.recordLastEdit(n,r),(x=void 0!==r.repeatOverride?r.repeatOverride:r.getRepeat())>0&&s.explicitRepeat?s.repeatIsExplicit=!0:(s.noRepeat||!s.explicitRepeat&&0===x)&&(x=1,s.repeatIsExplicit=!1),r.selectedCharacter&&(s.selectedCharacter=c.selectedCharacter=r.selectedCharacter),s.repeat=x,U(e),a){var g=Y[a](e,d,s,n,r);if(n.lastMotion=Y[a],!g)return;if(s.toJumplist){var v=t.jumpList,y=v.cachedCursor;y?(ew(e,y,g),delete v.cachedCursor):ew(e,d,g)}g instanceof Array?(k=g[0],C=g[1]):C=g,C||(C=eo(d)),n.visualMode?(n.visualBlock&&C.ch===1/0||(C=et(e,C,p)),k&&(k=et(e,k)),k=k||f,h.anchor=k,h.head=C,eg(e),eE(e,n,"<",es(k,C)?k:C),eE(e,n,">",es(k,C)?C:k)):l||(C=et(e,C,p),e.setCursor(C.line,C.ch))}if(l){if(c.lastSel){k=f;var C,k,x,S,M,L,b,A,E=c.lastSel,O=Math.abs(E.head.line-E.anchor.line),T=Math.abs(E.head.ch-E.anchor.ch);C=E.visualLine?new i(f.line+O,f.ch):E.visualBlock?new i(f.line+O,f.ch+T):E.head.line==E.anchor.line?new i(f.line,f.ch+T):new i(f.line+O,f.ch),n.visualMode=!0,n.visualLine=E.visualLine,n.visualBlock=E.visualBlock,h=n.sel={anchor:k,head:C},eg(e)}else n.visualMode&&(c.lastSel={anchor:eo(h.anchor),head:eo(h.head),visualBlock:n.visualBlock,visualLine:n.visualLine});if(n.visualMode){S=el(h.head,h.anchor),M=ec(h.head,h.anchor),L=n.visualLine||c.linewise,b=n.visualBlock?"block":L?"line":"char";var R=o(e,S,M);if(A=ev(e,{anchor:R.start,head:R.end},b),L){var N=A.ranges;if("block"==b)for(var B=0;B<N.length;B++)N[B].head.ch=eh(e,N[B].head.line);else"line"==b&&(N[0].head=new i(N[0].head.line+1,0))}}else{if(S=eo(k||f),es(M=eo(C||p),S)){var I,K,D=S;S=M,M=D}(L=s.linewise||c.linewise)?(I=S,K=M,I.ch=0,K.ch=0,K.line++):s.forward&&function(e,t,n){var r=e.getRange(t,n);if(/\n\s*$/.test(r)){var i=r.split("\n");i.pop();for(var o=i.pop();i.length>0&&o&&w(o);o=i.pop())n.line--,n.ch=0;o?(n.line--,n.ch=eh(e,n.line)):n.ch=0}}(e,S,M),b="char";var P=!s.inclusive||L,R=o(e,S,M);A=ev(e,{anchor:R.start,head:R.end},b,P)}e.setSelections(A.ranges,A.primary),n.lastMotion=null,c.repeat=x,c.registerName=u,c.linewise=L;var H=Z[l](e,c,A.ranges,f,C);n.visualMode&&ey(e,null!=H),H&&e.setCursor(H)}},recordLastEdit:function(e,n,r){var i=t.macroModeState;i.isPlaying||(e.lastEditInputState=n,e.lastEditActionCommand=r,i.lastInsertModeChanges.changes=[],i.lastInsertModeChanges.expectCursorActivityForChange=!1,i.lastInsertModeChanges.visualBlock=e.visualBlock?e.sel.head.line-e.sel.anchor.line:0)}},Y={moveToTopLine:function(e,t,n){var r=eQ(e).top+n.repeat-1;return new i(r,eC(e.getLine(r)))},moveToMiddleLine:function(e){var t=eQ(e),n=Math.floor((t.top+t.bottom)*.5);return new i(n,eC(e.getLine(n)))},moveToBottomLine:function(e,t,n){var r=eQ(e).bottom-n.repeat+1;return new i(r,eC(e.getLine(r)))},expandToLine:function(e,t,n){return new i(t.line+n.repeat-1,1/0)},findNext:function(e,t,n){var r=eB(e),i=r.getQuery();if(i){var o=!n.forward;o=r.isReversed()?!o:o,eW(e,i);var a=eU(e,o,i,n.repeat);return a||eF(e,"No match found "+i+(A("pcre")?" (set nopcre to use Vim regexps)":"")),a}},findAndSelectNextInclusive:function(t,n,r,o,a){var s,l,c=eB(t),u=c.getQuery();if(u){var h=!r.forward,d=(s=h=c.isReversed()?!h:h,l=r.repeat,t.operation(function(){void 0===l&&(l=1);var e=t.getCursor(),n=t.getSearchCursor(u,e),r=n.find(!s);!o.visualMode&&r&&ea(n.from(),e)&&n.find(!s);for(var a=0;a<l;a++)if(!(r=n.find(s))&&!(n=t.getSearchCursor(u,s?new i(t.lastLine()):new i(t.firstLine(),0))).find(s))return;var c=n.from(),h=n.to();return c&&h&&[c,h]}));if(d){if(a.operator)return d;var m=d[0],p=new i(d[1].line,d[1].ch-1);if(o.visualMode){(o.visualLine||o.visualBlock)&&(o.visualLine=!1,o.visualBlock=!1,e.signal(t,"vim-mode-change",{mode:"visual",subMode:""}));var f=o.sel.anchor;if(f)return c.isReversed()?r.forward?[f,m]:[f,p]:r.forward?[f,p]:[f,m]}else o.visualMode=!0,o.visualLine=!1,o.visualBlock=!1,e.signal(t,"vim-mode-change",{mode:"visual",subMode:""});return h?[p,m]:[m,p]}}},goToMark:function(e,t,n,r){var i=eJ(e,r,n.selectedCharacter||"");return i?n.linewise?{line:i.line,ch:eC(e.getLine(i.line))}:i:null},moveToOtherHighlightedEnd:function(e,t,n,r){var o=r.sel;return r.visualBlock&&n.sameLine?[et(e,new i(o.anchor.line,o.head.ch)),et(e,new i(o.head.line,o.anchor.ch))]:[o.head,o.anchor]},jumpToMark:function(e,t,n,r){for(var o=t,a=0;a<n.repeat;a++){var s=o;for(var l in r.marks)if(k(l)){var c=r.marks[l].find();if((n.forward?!es(c,s):!es(s,c))&&(!n.linewise||c.line!=s.line)){var u=ea(s,o),h=n.forward?eu(s,c,o):eu(o,c,s);(u||h)&&(o=c)}}}return n.linewise&&(o=new i(o.line,eC(e.getLine(o.line)))),o},moveByCharacters:function(e,t,n){var r=n.repeat,o=n.forward?t.ch+r:t.ch-r;return new i(t.line,o)},moveByLines:function(e,t,n,r){var o=t.ch;switch(r.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:o=r.lastHPos;break;default:r.lastHPos=o}var a=n.repeat+(n.repeatOffset||0),s=n.forward?t.line+a:t.line-a,l=e.firstLine(),c=e.lastLine(),u=e.findPosV(t,n.forward?a:-a,"line",r.lastHSPos);return((n.forward?u.line>s:u.line<s)&&(s=u.line,o=u.ch),s<l&&t.line==l)?this.moveToStartOfLine(e,t,n,r):s>c&&t.line==c?eb(e,t,n,r,!0):(n.toFirstChar&&(o=eC(e.getLine(s)),r.lastHPos=o),r.lastHSPos=e.charCoords(new i(s,o),"div").left,new i(s,o))},moveByDisplayLines:function(e,t,n,r){switch(r.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:r.lastHSPos=e.charCoords(t,"div").left}var o=n.repeat,a=e.findPosV(t,n.forward?o:-o,"line",r.lastHSPos);if(a.hitSide){if(n.forward){var s={top:e.charCoords(a,"div").top+8,left:r.lastHSPos};a=e.coordsChar(s,"div")}else{var l=e.charCoords(new i(e.firstLine(),0),"div");l.left=r.lastHSPos,a=e.coordsChar(l,"div")}}return r.lastHPos=a.ch,a},moveByPage:function(e,t,n){var r=n.repeat;return e.findPosV(t,n.forward?r:-r,"page")},moveByParagraph:function(e,t,n){var r=n.forward?1:-1;return eO(e,t,n.repeat,r).start},moveBySentence:function(e,t,n){var r=n.forward?1:-1;return function(e,t,n,r){function o(e,t){if(null!==t.line){if(t.pos+t.dir<0||t.pos+t.dir>=t.line.length){if(t.ln+=t.dir,!C(e,t.ln)){t.line=null;return}t.line=e.getLine(t.ln),t.pos=t.dir>0?0:t.line.length-1}else t.pos+=t.dir}}for(var a={ln:t.line,pos:t.ch};n>0;)a=r<0?function(e,t,n,r){var i=e.getLine(t),a={line:i,ln:t,pos:n,dir:r},s=a.ln,l=null,c=""===a.line;for(o(e,a);null!==a.line;){if(""!==a.line||c){if(x(a.line[a.pos])&&null!==l&&!(a.ln===s&&a.pos+1===l))return{ln:s,pos:l};""===a.line||w(a.line[a.pos])||(c=!1,s=a.ln,l=a.pos)}else{if(null!==l)return{ln:s,pos:l};return{ln:a.ln,pos:a.pos}}o(e,a)}var i=e.getLine(s);l=0;for(var u=0;u<i.length;++u)if(!w(i[u])){l=u;break}return{ln:s,pos:l}}(e,a.ln,a.pos,r):function(e,t,n,r){var i=e.getLine(t),a=""===i,s={line:i,ln:t,pos:n,dir:r},l={ln:s.ln,pos:s.pos},c=""===s.line;for(o(e,s);null!==s.line;){if(l.ln=s.ln,l.pos=s.pos,""===s.line&&!c||a&&""!==s.line&&!w(s.line[s.pos]))return{ln:s.ln,pos:s.pos};x(s.line[s.pos])&&!a&&(s.pos===s.line.length-1||w(s.line[s.pos+1]))&&(a=!0),o(e,s)}var i=e.getLine(l.ln);l.pos=0;for(var u=i.length-1;u>=0;--u)if(!w(i[u])){l.pos=u;break}return l}(e,a.ln,a.pos,r),n--;return new i(a.ln,a.pos)}(e,t,n.repeat,r)},moveByScroll:function(e,t,n,r){var i=e.getScrollInfo(),o=null,a=n.repeat;a||(a=i.clientHeight/(2*e.defaultTextHeight()));var s=e.charCoords(t,"local");if(n.repeat=a,!(o=Y.moveByDisplayLines(e,t,n,r)))return null;var l=e.charCoords(o,"local");return e.scrollTo(null,i.top+l.top-s.top),o},moveByWords:function(e,t,n){return function(e,t,n,r,o,a){var s=eo(t),l=[];(r&&!o||!r&&o)&&n++;for(var c=!(r&&o),u=0;u<n;u++){var h=eL(e,t,r,a,c);if(!h){var d=eh(e,e.lastLine());l.push(r?{line:e.lastLine(),from:d,to:d}:{line:0,from:0,to:0});break}l.push(h),t=new i(h.line,r?h.to-1:h.from)}var m=l.length!=n,p=l[0],f=l.pop();return r&&!o?(m||p.from==s.ch&&p.line==s.line||(f=l.pop()),f&&new i(f.line,f.from)):r&&o?f&&new i(f.line,f.to-1):!r&&o?(m||p.to==s.ch&&p.line==s.line||(f=l.pop()),f&&new i(f.line,f.to)):f&&new i(f.line,f.from)}(e,t,n.repeat,!!n.forward,!!n.wordEnd,!!n.bigWord)},moveTillCharacter:function(e,t,n){var r=eA(e,n.repeat,n.forward,n.selectedCharacter,t),i=n.forward?-1:1;return(ex(i,n),r)?(r.ch+=i,r):null},moveToCharacter:function(e,t,n){var r=n.repeat;return ex(0,n),eA(e,r,n.forward,n.selectedCharacter,t)||t},moveToSymbol:function(e,t,n){var r=n.repeat;return n.selectedCharacter&&function(e,t,n,r){var o=eo(e.getCursor()),a=n?1:-1,s=n?e.lineCount():-1,l=o.ch,c=o.line,u=e.getLine(c),h={lineText:u,nextCh:u.charAt(l),lastCh:null,index:l,symb:r,reverseSymb:(n?{")":"(","}":"{"}:{"(":")","{":"}"})[r],forward:n,depth:0,curMoveThrough:!1},d=eS[r];if(!d)return o;var m=eM[d].init,p=eM[d].isComplete;for(m&&m(h);c!==s&&t;){if(h.index+=a,h.nextCh=h.lineText.charAt(h.index),!h.nextCh){if(c+=a,h.lineText=e.getLine(c)||"",a>0)h.index=0;else{var f=h.lineText.length;h.index=f>0?f-1:0}h.nextCh=h.lineText.charAt(h.index)}p(h)&&(o.line=c,o.ch=h.index,t--)}return h.nextCh||h.curMoveThrough?new i(c,h.index):o}(e,r,n.forward,n.selectedCharacter)||t},moveToColumn:function(e,t,n,r){var o,a=n.repeat;return r.lastHPos=a-1,r.lastHSPos=e.charCoords(t,"div").left,o=e.getCursor().line,et(e,new i(o,a-1))},moveToEol:function(e,t,n,r){return eb(e,t,n,r,!1)},moveToFirstNonWhiteSpaceCharacter:function(e,t){return new i(t.line,eC(e.getLine(t.line)))},moveToMatchedSymbol:function(e,t){for(var n,r,o=t.line,a=t.ch,s=e.getLine(o);a<s.length;a++)if((n=s.charAt(a))&&(r=n,-1!="()[]{}".indexOf(r))){var l=e.getTokenTypeAt(new i(o,a+1));if("string"!==l&&"comment"!==l)break}if(!(a<s.length))return t;var c="<"===n||">"===n?/[(){}[\]<>]/:/[(){}[\]]/;return e.findMatchingBracket(new i(o,a),{bracketRegex:c}).to},moveToStartOfLine:function(e,t){return new i(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t,n){var r=n.forward?e.lastLine():e.firstLine();return n.repeatIsExplicit&&(r=n.repeat-e.getOption("firstLineNumber")),new i(r,eC(e.getLine(r)))},moveToStartOfDisplayLine:function(e){return e.execCommand("goLineLeft"),e.getCursor()},moveToEndOfDisplayLine:function(e){e.execCommand("goLineRight");var t=e.getCursor();return"before"==t.sticky&&t.ch--,t},textObjectManipulation:function(t,n,r,o){var a,s,l,c,u,h,d,m,p,f=r.selectedCharacter||"";"b"==f?f="(":"B"==f&&(f="{");var g=!r.textObjectInner;if(({"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"})[f]){if(p=!0,!(m=eR(t,n,f,g))){var v=t.getSearchCursor(RegExp("\\"+f,"g"),n);v.find()&&(m=eR(t,v.from(),f,g))}}else if(({"'":!0,'"':!0,"`":!0})[f])p=!0,m=function(e,t,n,r){var o,a,s,l,c=eo(t),u=e.getLine(c.line).split(""),h=u.indexOf(n);if(c.ch<h)c.ch=h;else if(h<c.ch&&u[c.ch]==n){var d=/string/.test(e.getTokenTypeAt(er(t,0,1))),m=/string/.test(e.getTokenTypeAt(t));!(d&&!m)&&(a=c.ch,--c.ch)}if(u[c.ch]!=n||a)for(s=c.ch;s>-1&&!o;s--)u[s]==n&&(o=s+1);else o=c.ch+1;if(o&&!a)for(s=o,l=u.length;s<l&&!a;s++)u[s]==n&&(a=s);return o&&a?(r&&(--o,++a),{start:new i(c.line,o),end:new i(c.line,a)}):{start:c,end:c}}(t,n,f,g);else if("W"===f||"w"===f)for(var y=r.repeat||1;y-- >0;){var C=ek(t,{inclusive:g,innerWord:!g,bigWord:"W"===f,noSymbol:"W"===f,multiline:!0},m&&m.end);C&&(m||(m=C),m.end=C.end)}else if("p"===f){if(m=eO(t,n,r.repeat,0,g),r.linewise=!0,o.visualMode)o.visualLine||(o.visualLine=!0);else{var k=o.inputState.operatorArgs;k&&(k.linewise=!0),m.end.line--}}else if("t"===f)m=function(t,n,r){if(!e.findMatchingTag||!e.findEnclosingTag)return{start:n,end:n};var i=e.findMatchingTag(t,n)||e.findEnclosingTag(t,n);return i&&i.open&&i.close?r?{start:i.open.from,end:i.close.to}:{start:i.open.to,end:i.close.from}:{start:n,end:n}}(t,n,g);else if("s"===f){var S=t.getLine(n.line);n.ch>0&&x(S[n.ch])&&(n.ch-=1);var M=eT(t,n,r.repeat,1,g),L=eT(t,n,r.repeat,-1,g);w(t.getLine(L.line)[L.ch])&&w(t.getLine(M.line)[M.ch-1])&&(L={line:L.line,ch:L.ch+1}),m={start:L,end:M}}return m?t.state.vim.visualMode?(a=m.start,s=m.end,l=p,u=t.state.vim.sel,h=l?a:u.head,d=l?a:u.anchor,es(s,a)&&(c=s,s=a,a=c),es(h,d)?(h=el(a,h),d=ec(d,s)):(d=el(a,d),-1==(h=er(h=ec(h,s),0,-1)).ch&&h.line!=t.firstLine()&&(h=new i(h.line-1,eh(t,h.line-1)))),[d,h]):[m.start,m.end]:null},repeatLastCharacterSearch:function(e,n,r){var i=t.lastCharacterSearch,o=r.repeat,a=r.forward===i.forward,s=(i.increment?1:0)*(a?-1:1);e.moveH(-s,"char"),r.inclusive=!!a;var l=eA(e,o,a,i.selectedCharacter);return l?(l.ch+=s,l):(e.moveH(s,"char"),n)}};function G(e,t){for(var n=[],r=0;r<t;r++)n.push(e);return n}var Z={change:function(e,n,r){var o,a,s=e.state.vim,l=r[0].anchor,c=r[0].head;if(s.visualMode){if(n.fullLine)c.ch=Number.MAX_VALUE,c.line--,e.setSelection(l,c),a=e.getSelection(),e.replaceSelection(""),o=l;else{a=e.getSelection();var u=G("",r.length);e.replaceSelections(u),o=el(r[0].head,r[0].anchor)}}else{a=e.getRange(l,c);var h=s.lastEditInputState;if(h?.motion=="moveByWords"&&!w(a)){var d=/\s+$/.exec(a);d&&h.motionArgs&&h.motionArgs.forward&&(c=er(c,0,-d[0].length),a=a.slice(0,-d[0].length))}n.linewise&&(l=new i(l.line,eC(e.getLine(l.line))),c.line>l.line&&(c=new i(c.line-1,Number.MAX_VALUE))),e.replaceRange("",l,c),o=l}t.registerController.pushText(n.registerName,"change",a,n.linewise,r.length>1),ee.enterInsertMode(e,{head:o},e.state.vim)},delete:function(e,n,r){var o,a,s=e.state.vim;if(s.visualBlock){a=e.getSelection();var l=G("",r.length);e.replaceSelections(l),o=el(r[0].head,r[0].anchor)}else{var c=r[0].anchor,u=r[0].head;n.linewise&&u.line!=e.firstLine()&&c.line==e.lastLine()&&c.line==u.line-1&&(c.line==e.firstLine()?c.ch=0:c=new i(c.line-1,eh(e,c.line-1))),a=e.getRange(c,u),e.replaceRange("",c,u),o=c,n.linewise&&(o=Y.moveToFirstNonWhiteSpaceCharacter(e,c))}return t.registerController.pushText(n.registerName,"delete",a,n.linewise,s.visualBlock),et(e,o)},indent:function(e,t,n){var r=e.state.vim,i=r.visualMode&&t.repeat||1;if(r.visualBlock){for(var o,a=e.getOption("tabSize"),s=e.getOption("indentWithTabs")?"	":" ".repeat(a),l=n.length-1;l>=0;l--)if(o=el(n[l].anchor,n[l].head),t.indentRight)e.replaceRange(s.repeat(i),o,o);else{for(var c=e.getLine(o.line),u=0,h=0;h<i;h++){var d=c[o.ch+u];if("	"==d)u++;else if(" "==d){u++;for(var m=1;m<s.length&&" "===(d=c[o.ch+u]);m++)u++}else break}e.replaceRange("",o,er(o,0,u))}return o}if(e.indentMore)for(var h=0;h<i;h++)t.indentRight?e.indentMore():e.indentLess();else{var p=n[0].anchor.line,f=r.visualBlock?n[n.length-1].anchor.line:n[0].head.line;t.linewise&&f--;for(var l=p;l<=f;l++)for(var h=0;h<i;h++)e.indentLine(l,t.indentRight)}return Y.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},indentAuto:function(e,t,n){return e.execCommand("indentAuto"),Y.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},hardWrap:function(e,t,n,r){if(e.hardWrap){var o=n[0].anchor.line,a=n[0].head.line;t.linewise&&a--;var s=e.hardWrap({from:o,to:a});return s>o&&t.linewise&&s--,t.keepCursor?r:new i(s,0)}},changeCase:function(e,t,n,r,i){for(var o=e.getSelections(),a=[],s=t.toLower,l=0;l<o.length;l++){var c=o[l],u="";if(!0===s)u=c.toLowerCase();else if(!1===s)u=c.toUpperCase();else for(var h=0;h<c.length;h++){var d=c.charAt(h);u+=y.test(d)?d.toLowerCase():d.toUpperCase()}a.push(u)}return(e.replaceSelections(a),t.shouldMoveCursor)?i:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?Y.moveToFirstNonWhiteSpaceCharacter(e,r):t.linewise?r:el(n[0].anchor,n[0].head)},yank:function(e,n,r,i){var o=e.state.vim,a=e.getSelection(),s=o.visualMode?el(o.sel.anchor,o.sel.head,r[0].head,r[0].anchor):i;return t.registerController.pushText(n.registerName,"yank",a,n.linewise,o.visualBlock),s},rot13:function(e,t,n,r,i){for(var o=e.getSelections(),a=[],s=0;s<o.length;s++){let e=o[s].split("").map(e=>{let t=e.charCodeAt(0);return t>=65&&t<=90?String.fromCharCode(65+(t-65+13)%26):t>=97&&t<=122?String.fromCharCode(97+(t-97+13)%26):e}).join("");a.push(e)}return(e.replaceSelections(a),t.shouldMoveCursor)?i:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?Y.moveToFirstNonWhiteSpaceCharacter(e,r):t.linewise?r:el(n[0].anchor,n[0].head)}},ee={jumpListWalk:function(e,n,r){if(!r.visualMode){var i=n.repeat||1,o=n.forward,a=t.jumpList.move(e,o?i:-i),s=a?a.find():void 0;s=s||e.getCursor(),e.setCursor(s)}},scroll:function(e,t,n){if(!n.visualMode){var r=t.repeat||1,i=e.defaultTextHeight(),o=e.getScrollInfo().top,a=i*r,s=t.forward?o+a:o-a,l=eo(e.getCursor()),c=e.charCoords(l,"local");if(t.forward)s>c.top?(l.line+=(s-c.top)/i,l.line=Math.ceil(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.top)):e.scrollTo(null,s);else{var u=s+e.getScrollInfo().clientHeight;u<c.bottom?(l.line-=(c.bottom-u)/i,l.line=Math.floor(l.line),e.setCursor(l),c=e.charCoords(l,"local"),e.scrollTo(null,c.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,s)}}},scrollToCursor:function(e,t){var n=e.getCursor().line,r=e.charCoords(new i(n,0),"local"),o=e.getScrollInfo().clientHeight,a=r.top;switch(t.position){case"center":a=r.bottom-o/2;break;case"bottom":var s=new i(n,e.getLine(n).length-1),l=e.charCoords(s,"local").bottom-a;a=a-o+l}e.scrollTo(null,a)},replayMacro:function(e,n,r){var i=n.selectedCharacter||"",o=n.repeat||1,a=t.macroModeState;for("@"==i?i=a.latestRegister||"":a.latestRegister=i;o--;)!function(e,n,r,i){var o=t.registerController.getRegister(i);if(":"==i){o.keyBuffer[0]&&eG.processCommand(e,o.keyBuffer[0]),r.isPlaying=!1;return}var a=o.keyBuffer,s=0;r.isPlaying=!0,r.replaySearchQueries=o.searchQueries.slice(0);for(var l=0;l<a.length;l++)for(var c,u,h=a[l],d=/<(?:[CSMA]-)*\w+>|./gi;c=d.exec(h);)if(u=c[0],I.handleKey(e,u,"macro"),n.insertMode){var m=o.insertModeChanges[s++].changes;t.macroModeState.lastInsertModeChanges.changes=m,e9(e,m,1),eZ(e)}r.isPlaying=!1}(e,r,a,i)},enterMacroRecordMode:function(e,n){var r=t.macroModeState,i=n.selectedCharacter;t.registerController.isValidRegister(i)&&r.enterMacroRecordMode(e,i)},toggleOverwrite:function(t){t.state.overwrite?(t.toggleOverwrite(!1),t.setOption("keyMap","vim-insert"),e.signal(t,"vim-mode-change",{mode:"insert"})):(t.toggleOverwrite(!0),t.setOption("keyMap","vim-replace"),e.signal(t,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(n,r,a){if(!n.getOption("readOnly")){a.insertMode=!0,a.insertModeRepeat=r&&r.repeat||1;var s=r?r.insertAt:null,l=a.sel,c=r.head||n.getCursor("head"),u=n.listSelections().length;if("eol"==s)c=new i(c.line,eh(n,c.line));else if("bol"==s)c=new i(c.line,0);else if("charAfter"==s){var h=o(n,c,er(c,0,1));c=h.end}else if("firstNonBlank"==s){var h=o(n,c,Y.moveToFirstNonWhiteSpaceCharacter(n,c));c=h.end}else if("startOfSelectedArea"==s){if(!a.visualMode)return;a.visualBlock?(c=new i(Math.min(l.head.line,l.anchor.line),Math.min(l.head.ch,l.anchor.ch)),u=Math.abs(l.head.line-l.anchor.line)+1):c=l.head.line<l.anchor.line?l.head:new i(l.anchor.line,0)}else if("endOfSelectedArea"==s){if(!a.visualMode)return;a.visualBlock?(c=new i(Math.min(l.head.line,l.anchor.line),Math.max(l.head.ch,l.anchor.ch)+1),u=Math.abs(l.head.line-l.anchor.line)+1):c=l.head.line>=l.anchor.line?er(l.head,0,1):new i(l.anchor.line,0)}else if("inplace"==s){if(a.visualMode)return}else"lastEdit"==s&&(c=ez(n)||c);n.setOption("disableInput",!1),r&&r.replace?(n.toggleOverwrite(!0),n.setOption("keyMap","vim-replace"),e.signal(n,"vim-mode-change",{mode:"replace"})):(n.toggleOverwrite(!1),n.setOption("keyMap","vim-insert"),e.signal(n,"vim-mode-change",{mode:"insert"})),t.macroModeState.isPlaying||(n.on("change",e1),a.insertEnd&&a.insertEnd.clear(),a.insertEnd=n.setBookmark(c,{insertLeft:!0}),e.on(n.getInputField(),"keydown",e3)),a.visualMode&&ey(n),ep(n,c,u)}},toggleVisualMode:function(t,n,r){var a,s=n.repeat,l=t.getCursor();if(r.visualMode)!!n.linewise!=r.visualLine||!!n.blockwise!=r.visualBlock?(r.visualLine=!!n.linewise,r.visualBlock=!!n.blockwise,e.signal(t,"vim-mode-change",{mode:"visual",subMode:r.visualLine?"linewise":r.visualBlock?"blockwise":""}),eg(t)):ey(t);else{r.visualMode=!0,r.visualLine=!!n.linewise,r.visualBlock=!!n.blockwise,a=et(t,new i(l.line,l.ch+s-1));var c=o(t,l,a);r.sel={anchor:c.start,head:c.end},e.signal(t,"vim-mode-change",{mode:"visual",subMode:r.visualLine?"linewise":r.visualBlock?"blockwise":""}),eg(t),eE(t,r,"<",el(l,a)),eE(t,r,">",ec(l,a))}},reselectLastSelection:function(t,n,r){var i=r.lastSelection;if(r.visualMode&&ef(t,r),i){var o=i.anchorMark.find(),a=i.headMark.find();if(!o||!a)return;r.sel={anchor:o,head:a},r.visualMode=!0,r.visualLine=i.visualLine,r.visualBlock=i.visualBlock,eg(t),eE(t,r,"<",el(o,a)),eE(t,r,">",ec(o,a)),e.signal(t,"vim-mode-change",{mode:"visual",subMode:r.visualLine?"linewise":r.visualBlock?"blockwise":""})}},joinLines:function(e,t,n){if(n.visualMode){if(r=e.getCursor("anchor"),es(o=e.getCursor("head"),r)){var r,o,a=o;o=r,r=a}o.ch=eh(e,o.line)-1}else{var s=Math.max(t.repeat,2);r=e.getCursor(),o=et(e,new i(r.line+s-1,1/0))}for(var l=0,c=r.line;c<o.line;c++){l=eh(e,r.line);var u="",h=0;if(!t.keepSpaces){var d=e.getLine(r.line+1);-1==(h=d.search(/\S/))?h=d.length:u=" "}e.replaceRange(u,new i(r.line,l),new i(r.line+1,h))}var m=et(e,new i(r.line,l));n.visualMode&&ey(e,!1),e.setCursor(m)},newLineAndEnterInsertMode:function(t,n,r){r.insertMode=!0;var o=eo(t.getCursor());o.line!==t.firstLine()||n.after?(o.line=n.after?o.line:o.line-1,o.ch=eh(t,o.line),t.setCursor(o),(e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent)(t)):(t.replaceRange("\n",new i(t.firstLine(),0)),t.setCursor(t.firstLine(),0)),this.enterInsertMode(t,{repeat:n.repeat},r)},paste:function(e,n,r){var i=t.registerController.getRegister(n.registerName);if("+"===n.registerName)navigator.clipboard.readText().then(t=>{this.continuePaste(e,n,r,t,i)});else{var o=i.toString();this.continuePaste(e,n,r,o,i)}},continuePaste:function(e,n,r,o,a){var s=eo(e.getCursor());if(o){if(n.matchIndent){var l=e.getOption("tabSize"),c=function(e){return(e.split("	").length-1)*l+1*(e.split(" ").length-1)},u=c(e.getLine(e.getCursor().line).match(/^\s*/)[0]),h=o.replace(/\n$/,""),d=o!==h,m=c(o.match(/^\s*/)[0]),o=h.replace(/^\s*/gm,function(t){var n=u+(c(t)-m);return n<0?"":e.getOption("indentWithTabs")?Array(Math.floor(n/l)+1).join("	"):Array(n+1).join(" ")});o+=d?"\n":""}n.repeat>1&&(o=Array(n.repeat+1).join(o));var p=a.linewise,f=a.blockwise,g=f?o.split("\n"):void 0;if(g){p&&g.pop();for(var v=0;v<g.length;v++)g[v]=""==g[v]?" ":g[v];s.ch+=n.after?1:0,s.ch=Math.min(eh(e,s.line),s.ch)}else p?r.visualMode?o=r.visualLine?o.slice(0,-1):"\n"+o.slice(0,o.length-1)+"\n":n.after?(o="\n"+o.slice(0,o.length-1),s.ch=eh(e,s.line)):s.ch=0:s.ch+=n.after?1:0;if(r.visualMode){r.lastPastedText=o;var y,C,k,w,x,S=(C=(y=e.listSelections())[0],k=y[y.length-1],[es(C.anchor,C.head)?C.anchor:C.head,es(k.anchor,k.head)?k.head:k.anchor]),M=S[0],L=S[1],b=e.getSelection(),A=Array(e.listSelections().length).join("1").split("1");r.lastSelection&&(x=r.lastSelection.headMark.find()),t.registerController.unnamedRegister.setText(b),f?(e.replaceSelections(A),L=new i(M.line+o.length-1,M.ch),e.setCursor(M),em(e,L),e.replaceSelections(o),w=M):r.visualBlock?(e.replaceSelections(A),e.setCursor(M),e.replaceRange(o,M,M),w=M):(e.replaceRange(o,M,L),w=e.posFromIndex(e.indexFromPos(M)+o.length-1)),x&&(r.lastSelection.headMark=e.setBookmark(x)),p&&(w.ch=0)}else if(f&&g){e.setCursor(s);for(var v=0;v<g.length;v++){var E=s.line+v;E>e.lastLine()&&e.replaceRange("\n",new i(E,0)),eh(e,E)<s.ch&&function(e,t,n){var r=eh(e,t),o=Array(n-r+1).join(" ");e.setCursor(new i(t,r)),e.replaceRange(o,e.getCursor())}(e,E,s.ch)}e.setCursor(s),em(e,new i(s.line+g.length-1,s.ch)),e.replaceSelections(g),w=s}else if(e.replaceRange(o,s),p){var E=n.after?s.line+1:s.line;w=new i(E,eC(e.getLine(E)))}else w=eo(s),/\n/.test(o)||(w.ch+=o.length-(n.after?1:0));r.visualMode&&ey(e,!1),e.setCursor(w)}},undo:function(t,n){t.operation(function(){ei(t,e.commands.undo,n.repeat)(),t.setCursor(et(t,t.getCursor("start")))})},redo:function(t,n){ei(t,e.commands.redo,n.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},insertRegister:function(e,n,r){var i=n.selectedCharacter,o=t.registerController.getRegister(i),a=o&&o.toString();a&&e.replaceSelection(a)},oneNormalCommand:function(t,n,r){eZ(t,!0),r.insertModeReturn=!0,e.on(t,"vim-command-done",function n(){r.visualMode||(r.insertModeReturn&&(r.insertModeReturn=!1,r.insertMode||ee.enterInsertMode(t,{},r)),e.off(t,"vim-command-done",n))})},setMark:function(e,t,n){var r=t.selectedCharacter;r&&eE(e,n,r,e.getCursor())},replace:function(t,n,r){var a,s,l=n.selectedCharacter||"",c=t.getCursor(),u=t.listSelections();if(r.visualMode)c=t.getCursor("start"),s=t.getCursor("end");else{var h=t.getLine(c.line);(a=c.ch+n.repeat)>h.length&&(a=h.length),s=new i(c.line,a)}var d=o(t,c,s);if(c=d.start,s=d.end,"\n"==l)r.visualMode||t.replaceRange("",c,s),(e.commands.newlineAndIndentContinueComment||e.commands.newlineAndIndent)(t);else{var m=t.getRange(c,s);if(m=(m=m.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,l)).replace(/[^\n]/g,l),r.visualBlock){var p=Array(t.getOption("tabSize")+1).join(" "),f=(m=(m=t.getSelection()).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,l)).replace(/\t/g,p).replace(/[^\n]/g,l).split("\n");t.replaceSelections(f)}else t.replaceRange(m,c,s);r.visualMode?(c=es(u[0].anchor,u[0].head)?u[0].anchor:u[0].head,t.setCursor(c),ey(t,!1)):t.setCursor(er(s,0,-1))}},incrementNumberToken:function(e,t){for(var n,r,o,a,s=e.getCursor(),l=e.getLine(s.line),c=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi;null!==(n=c.exec(l))&&(o=(r=n.index)+n[0].length,!(s.ch<o)););if(t.backtrack||!(o<=s.ch)){if(!n)return;var u=n[2]||n[4],h=n[3]||n[5],d=t.increase?1:-1,m={"0b":2,0:8,"":10,"0x":16}[u.toLowerCase()];a=(parseInt(n[1]+h,m)+d*t.repeat).toString(m);var p=u?Array(h.length-a.length+1+n[1].length).join("0"):"";a="-"===a.charAt(0)?"-"+u+p+a.substr(1):u+p+a;var f=new i(s.line,r),g=new i(s.line,o);e.replaceRange(a,f,g),e.setCursor(new i(s.line,r+a.length-1))}},repeatLastEdit:function(e,t,n){var r=n.lastEditInputState;if(r){var i=t.repeat;i&&t.repeatIsExplicit?r.repeatOverride=i:i=r.repeatOverride||i,e5(e,n,i,!1)}},indent:function(e,t){e.indentLine(e.getCursor().line,t.indentRight)},exitInsertMode:function(e,t){eZ(e)}};function et(e,t,n){var r=e.state.vim,o=r.insertMode||r.visualMode,a=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),s=e.getLine(a),l=s.length-1+Number(!!o),c=Math.min(Math.max(0,t.ch),l),u=s.charCodeAt(c);if(56320<=u&&u<=57343){var h=1;n&&n.line==a&&n.ch>c&&(h=-1),(c+=h)>l&&(c-=2)}return new i(a,c)}function en(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function er(e,t,n){return"object"==typeof t&&(n=t.ch,t=t.line),new i(e.line+t,e.ch+n)}function ei(e,t,n){return function(){for(var r=0;r<n;r++)t(e)}}function eo(e){return new i(e.line,e.ch)}function ea(e,t){return e.ch==t.ch&&e.line==t.line}function es(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function el(e,t){return arguments.length>2&&(t=el.apply(void 0,Array.prototype.slice.call(arguments,1))),es(e,t)?e:t}function ec(e,t){return arguments.length>2&&(t=ec.apply(void 0,Array.prototype.slice.call(arguments,1))),es(e,t)?t:e}function eu(e,t,n){var r=es(e,t),i=es(t,n);return r&&i}function eh(e,t){return e.getLine(t).length}function ed(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function em(e,t){var n=[],r=e.listSelections(),o=eo(e.clipPos(t)),a=!ea(t,o),s=function(e,t,n){for(var r=0;r<e.length;r++){var i=ea(e[r].anchor,t),o=ea(e[r].head,t);if(i||o)return r}return -1}(r,e.getCursor("head")),l=ea(r[s].head,r[s].anchor),c=r.length-1,u=c-s>s?c:0,h=r[u].anchor,d=Math.min(h.line,o.line),m=Math.max(h.line,o.line),p=h.ch,f=o.ch,g=r[u].head.ch-p,v=f-p;g>0&&v<=0?(p++,!a&&f--):g<0&&v>=0?(p--,!l&&f++):g<0&&-1==v&&(p--,f++);for(var y=d;y<=m;y++){var C={anchor:new i(y,p),head:new i(y,f)};n.push(C)}return e.setSelections(n),t.ch=f,h.ch=p,h}function ep(e,t,n){for(var r=[],i=0;i<n;i++){var o=er(t,i,0);r.push({anchor:o,head:o})}e.setSelections(r,0)}function ef(e,t){var n=t.sel.anchor,r=t.sel.head;t.lastPastedText&&(r=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=void 0),t.lastSelection={anchorMark:e.setBookmark(n),headMark:e.setBookmark(r),anchor:eo(n),head:eo(r),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function eg(e,t,n){var r=e.state.vim;t=t||r.sel,n||(n=r.visualLine?"line":r.visualBlock?"block":"char");var i=ev(e,t,n);e.setSelections(i.ranges,i.primary)}function ev(e,t,n,r){var o=eo(t.head),a=eo(t.anchor);if("char"==n){var s=r||es(t.head,t.anchor)?0:1,l=es(t.head,t.anchor)?1:0;return o=er(t.head,0,s),{ranges:[{anchor:a=er(t.anchor,0,l),head:o}],primary:0}}if("line"==n){if(es(t.head,t.anchor))o.ch=0,a.ch=eh(e,a.line);else{a.ch=0;var c=e.lastLine();o.line>c&&(o.line=c),o.ch=eh(e,o.line)}return{ranges:[{anchor:a,head:o}],primary:0}}if("block"==n){var u=Math.min(a.line,o.line),h=a.ch,d=Math.max(a.line,o.line),m=o.ch;h<m?m+=1:h+=1;for(var p=d-u+1,f=o.line==u?0:p-1,g=[],v=0;v<p;v++)g.push({anchor:new i(u+v,h),head:new i(u+v,m)});return{ranges:g,primary:f}}throw"never happens"}function ey(t,n){var r=t.state.vim;!1!==n&&t.setCursor(et(t,r.sel.head)),ef(t,r),r.visualMode=!1,r.visualLine=!1,r.visualBlock=!1,r.insertMode||e.signal(t,"vim-mode-change",{mode:"normal"})}function eC(e){if(!e)return 0;var t=e.search(/\S/);return -1==t?e.length:t}function ek(e,{inclusive:t,innerWord:n,bigWord:r,noSymbol:o,multiline:a},s){var l,c,u=s||(l=e.getCursor("head"),1==e.getSelection().length&&(l=el(l,e.getCursor("anchor"))),l),h=e.getLine(u.line),d=h,f=u.line,g=f,v=u.ch,y=o?m[0]:p[0];if(n&&/\s/.test(h.charAt(v)))y=function(e){return/\s/.test(e)};else{for(;!y(h.charAt(v));)if(++v>=h.length){if(!a)return null;v--,c=eL(e,u,!0,r,!0);break}r?y=p[0]:(y=m[0])(h.charAt(v))||(y=m[1])}for(var C=v,k=v;y(h.charAt(k))&&k>=0;)k--;if(k++,c)C=c.to,g=c.line,!(d=e.getLine(g))&&0==C&&C++;else for(;y(h.charAt(C))&&C<h.length;)C++;if(t){var w=C,x=u.ch<=k&&/\s/.test(h.charAt(u.ch));if(!x)for(;/\s/.test(d.charAt(C))&&C<d.length;)C++;if(w==C||x){for(var S=k;/\s/.test(h.charAt(k-1))&&k>0;)k--;k||x||(k=S)}}return{start:new i(f,k),end:new i(g,C)}}function ew(e,n,r){ea(n,r)||t.jumpList.add(e,n,r)}function ex(e,n){t.lastCharacterSearch.increment=e,t.lastCharacterSearch.forward=n.forward,t.lastCharacterSearch.selectedCharacter=n.selectedCharacter}var eS={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},eM={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,e.depth>=1)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/^#(\w+)/)?.[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};function eL(e,t,n,r,i){var o=t.line,a=t.ch,s=e.getLine(o),l=n?1:-1,c=r?p:m;if(i&&""==s){if(o+=l,s=e.getLine(o),!C(e,o))return null;a=n?0:s.length}for(;;){if(i&&""==s)return{from:0,to:0,line:o};for(var u=l>0?s.length:-1,h=u,d=u;a!=u;){for(var f=!1,g=0;g<c.length&&!f;++g)if(c[g](s.charAt(a))){for(h=a;a!=u&&c[g](s.charAt(a));)a+=l;if(f=h!=(d=a),h==t.ch&&o==t.line&&d==h+l)continue;return{from:Math.min(h,d+1),to:Math.max(h,d),line:o}}f||(a+=l)}if(!C(e,o+=l))return null;s=e.getLine(o),a=l>0?0:s.length}}function eb(e,t,n,r,o){var a=new i(t.line+n.repeat-1,1/0),s=e.clipPos(a);return s.ch--,o||(r.lastHPos=1/0,r.lastHSPos=e.charCoords(s,"div").left),a}function eA(e,t,n,r,o){if(r){for(var a,s=o||e.getCursor(),l=s.ch,c=0;c<t;c++){var u,h,d,m=void 0;if(-1==(u=l,h=e.getLine(s.line),d=r,a=n?h.indexOf(d,u+1):h.lastIndexOf(d,u-1)))return;l=a}if(void 0!=a)return new i(e.getCursor().line,a)}}function eE(e,t,n,r){(S(n,f)||v.test(n))&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(r))}function eO(e,t,n,r,o){var a,s=t.line,l=e.firstLine(),c=e.lastLine(),u=s;function h(t){return!e.getLine(t)}function d(e,t,n){return n?h(e)!=h(e+t):!h(e)&&h(e+t)}if(r){for(;l<=u&&u<=c&&n>0;)d(u,r)&&n--,u+=r;return{start:new i(u,0),end:t}}var m=e.state.vim;if(m.visualLine&&d(s,1,!0)){var p=m.sel.anchor;d(p.line,-1,!0)&&(!o||p.line!=s)&&(s+=1)}var f=h(s);for(u=s;u<=c&&n;u++)d(u,1,!0)&&(!o||h(u)!=f)&&n--;for(a=new i(u,0),u>c&&!f?f=!0:o=!1,u=s;u>l&&!((!o||h(u)==f||u==s)&&d(u,-1,!0));u--);return{start:new i(u,0),end:a}}function eT(e,t,n,r,o){function a(e){null!==e.line&&(e.pos+e.dir<0||e.pos+e.dir>=e.line.length?e.line=null:e.pos+=e.dir)}for(var s={ln:t.line,pos:t.ch};n>0;)s=r<0?function(e,t,n,r){var i=e.getLine(t),s={line:i,ln:t,pos:n,dir:r};if(""===s.line)return{ln:s.ln,pos:s.pos};var l=s.pos;for(a(s);null!==s.line;){if(w(s.line[s.pos])||x(s.line[s.pos])){if(x(s.line[s.pos])){if(!o)return{ln:s.ln,pos:l};if(w(s.line[s.pos+1]))return{ln:s.ln,pos:s.pos+1};return{ln:s.ln,pos:l}}}else l=s.pos;a(s)}return(s.line=i,o&&w(s.line[s.pos]))?{ln:s.ln,pos:s.pos}:{ln:s.ln,pos:l}}(e,s.ln,s.pos,r):function(e,t,n,r){var i={line:e.getLine(t),ln:t,pos:n,dir:r};if(""===i.line)return{ln:i.ln,pos:i.pos};var s=i.pos;for(a(i);null!==i.line;){if(s=i.pos,x(i.line[i.pos])){if(!o)return{ln:i.ln,pos:i.pos+1};for(a(i);null!==i.line;)if(w(i.line[i.pos]))s=i.pos,a(i);else break;break}a(i)}return{ln:i.ln,pos:s+1}}(e,s.ln,s.pos,r),n--;return new i(s.ln,s.pos)}function eR(e,t,n,r){var o={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[n],a=e.getLine(t.line).charAt(t.ch)===({"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"})[n]?1:0,s=e.scanForBracket(new i(t.line,t.ch+a),-1,void 0,{bracketRegex:o}),l=e.scanForBracket(new i(t.line,t.ch+a),1,void 0,{bracketRegex:o});if(!s||!l)return null;var c=s.pos,u=l.pos;if(c.line==u.line&&c.ch>u.ch||c.line>u.line){var h=c;c=u,u=h}return r?u.ch+=1:c.ch+=1,{start:c,end:u}}L("pcre",!0,"boolean");class eN{constructor(){this.highlightTimeout}getQuery(){return t.query}setQuery(e){t.query=e}getOverlay(){return this.searchOverlay}setOverlay(e){this.searchOverlay=e}isReversed(){return t.isReversed}setReversed(e){t.isReversed=e}getScrollbarAnnotate(){return this.annotate}setScrollbarAnnotate(e){this.annotate=e}}function eB(e){var t=e.state.vim;return t.searchState_||(t.searchState_=new eN)}function eI(e,t){var n=eK(e,t)||[];if(!n.length)return[];var r=[];if(0===n[0]){for(var i=0;i<n.length;i++)"number"==typeof n[i]&&r.push(e.substring(n[i]+1,n[i+1]));return r}}function eK(e,t){t||(t="/");for(var n=!1,r=[],i=0;i<e.length;i++){var o=e.charAt(i);n||o!=t||r.push(i),n=!n&&"\\"==o}return r}var eD={"\\n":"\n","\\r":"\r","\\t":"	"},eP={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"	","\\&":"&"};function eH(e,n,r){t.registerController.getRegister("/").setText(e);var i,o,a,s,l,c,u,h,d=eK(e,"/");return(d.length?(i=e.substring(0,d[0]),o=-1!=e.substring(d[0]).indexOf("i")):i=e,i)?(A("pcre")||(a=i,l={">":"(?<=[\\w])(?=[^\\w]|$)","<":"(?<=[^\\w]|^)(?=[\\w])"},c=(s={V:"|(){+?*.[$^",M:"|(){+?*.[",m:"|(){+?",v:"<>"}).m,-1!=(h=(u=a.replace(/\\.|[\[|(){+*?.$^<>]/g,function(e){if("\\"===e[0]){var t=e[1];return"}"===t||-1!=c.indexOf(t)?t:t in s?(c=s[t],""):t in l?l[t]:e}return -1!=c.indexOf(e)?l[e]||"\\"+e:e})).indexOf("\\zs"))&&(u="(?<="+u.slice(0,h)+")"+u.slice(h+3)),-1!=(h=u.indexOf("\\ze"))&&(u=u.slice(0,h)+"(?="+u.slice(h+3)+")"),i=u),r&&(n=/^[^A-Z]*$/.test(i)),new RegExp(i,n||o?"im":"m")):null}function ej(e){"string"==typeof e&&(e=document.createElement(e));for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n){if("object"!=typeof n&&(n=document.createTextNode(n)),n.nodeType)e.appendChild(n);else for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&("$"===r[0]?e.style[r.slice(1)]=n[r]:"function"==typeof n[r]?e[r]=n[r]:e.setAttribute(r,n[r]))}}return e}function eF(e,t,n){var r=ej("div",{$color:"red",$whiteSpace:"pre",class:"cm-vim-message"},t);e.openNotification?n?(r=ej("div",{},r,ej("div",{},"Press ENTER or type command to continue")),e.state.closeVimNotification&&e.state.closeVimNotification(),e.state.closeVimNotification=e.openNotification(r,{bottom:!0,duration:0})):e.openNotification(r,{bottom:!0,duration:15e3}):alert(r.innerText)}function eV(e,t){if(K.length){t.value||(t.value=""),r=t;return}var n,i,o=(n=t.prefix,i=t.desc,ej("div",{$display:"flex",$flex:1},ej("span",{$fontFamily:"monospace",$whiteSpace:"pre",$flex:1,$display:"flex"},n,ej("input",{type:"text",autocorrect:"off",autocapitalize:"off",spellcheck:"false",$flex:1})),i&&ej("span",{$color:"#888"},i)));if(e.openDialog)e.openDialog(o,t.onClose,{onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,bottom:!0,selectValueOnOpen:!1,value:t.value});else{var a="";"string"!=typeof t.prefix&&t.prefix&&(a+=t.prefix.textContent),t.desc&&(a+=" "+t.desc),t.onClose?.(prompt(a,""))}}function e_(e,t,n,r){if(t){var i,o=eB(e),a=eH(t,!!n,!!r);if(a)return eW(e,a),i=o.getQuery(),a instanceof RegExp&&i instanceof RegExp&&a.flags==i.flags&&a.source==i.source||o.setQuery(a),a}}var e$=0;function eW(e,t){clearTimeout(e$),eB(e).highlightTimeout=e$,e$=setTimeout(function(){if(e.state.vim){var n=eB(e);n.highlightTimeout=void 0;var r=n.getOverlay();r&&t==r.query||(r&&e.removeOverlay(r),r=function(e){if("^"==e.source.charAt(0))var t=!0;return{token:function(n){if(t&&!n.sol()){n.skipToEnd();return}var r=n.match(e,!1);if(r)return 0==r[0].length?(n.next(),"searching"):n.sol()||(n.backUp(1),e.exec(n.next()+r[0]))?(n.match(e),"searching"):(n.next(),null);for(;!n.eol()&&(n.next(),!n.match(e,!1)););},query:e}}(t),e.addOverlay(r),e.showMatchesOnScrollbar&&(n.getScrollbarAnnotate()&&n.getScrollbarAnnotate().clear(),n.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))),n.setOverlay(r))}},50)}function eU(e,t,n,r){return e.operation(function(){void 0===r&&(r=1);for(var o=e.getCursor(),a=e.getSearchCursor(n,o),s=0;s<r;s++){var l=a.find(t);if(0==s&&l&&ea(a.from(),o)){var c=t?a.from():a.to();(l=a.find(t))&&!l[0]&&ea(a.from(),c)&&e.getLine(c.line).length==c.ch&&(l=a.find(t))}if(!l&&!(a=e.getSearchCursor(n,t?new i(e.lastLine()):new i(e.firstLine(),0))).find(t))return}return a.from()})}function eq(e){var t=eB(e);t.highlightTimeout&&(clearTimeout(t.highlightTimeout),t.highlightTimeout=void 0),e.removeOverlay(eB(e).getOverlay()),t.setOverlay(null),t.getScrollbarAnnotate()&&(t.getScrollbarAnnotate().clear(),t.setScrollbarAnnotate(null))}function eQ(e){var t=e.getScrollInfo(),n=e.coordsChar({left:0,top:6+t.top},"local"),r=t.clientHeight-10+t.top,i=e.coordsChar({left:0,top:r},"local");return{top:n.line,bottom:i.line}}function eJ(e,n,r){if("'"==r||"`"==r)return t.jumpList.find(e,-1)||new i(0,0);if("."==r)return ez(e);var o=n.marks[r];return o&&o.find()}function ez(e){if(e.getLastEditEnd)return e.getLastEditEnd();for(var t=e.doc.history.done,n=t.length;n--;)if(t[n].changes)return eo(t[n].changes[0].to)}class eX{constructor(){this.commandMap_,this.buildCommandMap_()}processCommand(e,t,n){var r=this;e.operation(function(){e.curOp&&(e.curOp.isVimOp=!0),r._processCommand(e,t,n)})}_processCommand(n,r,i){var o,a,s=n.state.vim,l=t.registerController.getRegister(":"),c=l.toString(),u=new e.StringStream(r);l.setText(r);var h=i||{};h.input=r;try{this.parseInput_(n,u,h)}catch(e){throw eF(n,e+""),e}if(s.visualMode&&ey(n),h.commandName){if(o=this.matchCommand_(h.commandName)){if(a=o.name,o.excludeFromCommandHistory&&l.setText(c),this.parseCommandArgs_(u,h,o),"exToKey"==o.type){P(n,o.toKeys||"",o);return}if("exToEx"==o.type){this.processCommand(n,o.toInput||"");return}}}else void 0!==h.line&&(a="move");if(!a){eF(n,'Not an editor command ":'+r+'"');return}try{eY[a](n,h),o&&o.possiblyAsync||!h.callback||h.callback()}catch(e){throw eF(n,e+""),e}}parseInput_(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),void 0!==n.line&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t))),void 0==n.line?e.state.vim.visualMode?(n.selectionLine=eJ(e,e.state.vim,"<")?.line,n.selectionLineEnd=eJ(e,e.state.vim,">")?.line):n.selectionLine=e.getCursor().line:(n.selectionLine=n.line,n.selectionLineEnd=n.lineEnd);var r=t.match(/^(\w+|!!|@@|[!#&*<=>@~])/);return r?n.commandName=r[1]:n.commandName=(t.match(/.*/)||[""])[0],n}parseLineSpec_(e,t){var n=t.match(/^(\d+)/);if(n)return parseInt(n[1],10)-1;switch(t.next()){case".":return this.parseLineSpecOffset_(t,e.getCursor().line);case"$":return this.parseLineSpecOffset_(t,e.lastLine());case"'":var r=t.next()||"",i=eJ(e,e.state.vim,r);if(!i)throw Error("Mark not set");return this.parseLineSpecOffset_(t,i.line);case"-":case"+":return t.backUp(1),this.parseLineSpecOffset_(t,e.getCursor().line);default:t.backUp(1);return}}parseLineSpecOffset_(e,t){var n=e.match(/^([+-])?(\d+)/);if(n){var r=parseInt(n[2],10);"-"==n[1]?t-=r:t+=r}return t}parseCommandArgs_(e,t,n){if(!e.eol()){t.argString=e.match(/.*/)?.[0];var r=n.argDelimiter||/\s+/,i=ed(t.argString||"").split(r);i.length&&i[0]&&(t.args=i)}}matchCommand_(e){for(var t=e.length;t>0;t--){var n=e.substring(0,t);if(this.commandMap_[n]){var r=this.commandMap_[n];if(0===r.name.indexOf(e))return r}}}buildCommandMap_(){this.commandMap_={};for(var e=0;e<c.length;e++){var t=c[e],n=t.shortName||t.name;this.commandMap_[n]=t}}map(e,t,n,r){if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var i=e.substring(1);":"!=t&&":"==t.charAt(0)?this.commandMap_[i]={name:i,type:"exToEx",toInput:t.substring(1),user:!0}:this.commandMap_[i]={name:i,type:"exToKey",toKeys:t,user:!0}}else{var o={keys:e,type:"keyToKey",toKeys:t,noremap:!!r};n&&(o.context=n),e0(o)}}unmap(e,t){if(":"!=e&&":"==e.charAt(0)){if(t)throw Error("Mode not supported for ex mappings");var n=e.substring(1);if(this.commandMap_[n]&&this.commandMap_[n].user)return delete this.commandMap_[n],!0}else for(var r=0;r<a.length;r++)if(e==a[r].keys&&a[r].context===t)return a.splice(r,1),function(e){e.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(e){s[e]&&s[e]--})}(e),!0}}var eY={colorscheme:function(e,t){if(!t.args||t.args.length<1){eF(e,e.getOption("theme"));return}e.setOption("theme",t.args[0])},map:function(e,t,n,r){var i=t.args;if(!i||i.length<2){e&&eF(e,"Invalid mapping: "+t.input);return}eG.map(i[0],i[1],n,r)},imap:function(e,t){this.map(e,t,"insert")},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},omap:function(e,t){this.map(e,t,"operatorPending")},noremap:function(e,t){this.map(e,t,void 0,!0)},inoremap:function(e,t){this.map(e,t,"insert",!0)},nnoremap:function(e,t){this.map(e,t,"normal",!0)},vnoremap:function(e,t){this.map(e,t,"visual",!0)},onoremap:function(e,t){this.map(e,t,"operatorPending",!0)},unmap:function(e,t,n){var r=t.args;(!r||r.length<1||!eG.unmap(r[0],n))&&e&&eF(e,"No such mapping: "+t.input)},mapclear:function(e,t){I.mapclear()},imapclear:function(e,t){I.mapclear("insert")},nmapclear:function(e,t){I.mapclear("normal")},vmapclear:function(e,t){I.mapclear("visual")},omapclear:function(e,t){I.mapclear("operatorPending")},move:function(e,t){X.processCommand(e,e.state.vim,{keys:"",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args,r=t.setCfg||{};if(!n||n.length<1){e&&eF(e,"Invalid mapping: "+t.input);return}var i=n[0].split("="),o=i.shift()||"",a=i.length>0?i.join("="):void 0,s=!1,l=!1;if("?"==o.charAt(o.length-1)){if(a)throw Error("Trailing characters: "+t.argString);o=o.substring(0,o.length-1),s=!0}else"!"==o.charAt(o.length-1)&&(o=o.substring(0,o.length-1),l=!0);void 0===a&&"no"==o.substring(0,2)&&(o=o.substring(2),a=!1);var c=M[o]&&"boolean"==M[o].type;if(c&&(l?a=!A(o,e,r):void 0==a&&(a=!0)),!c&&void 0===a||s){var u=A(o,e,r);u instanceof Error?eF(e,u.message):!0===u||!1===u?eF(e," "+(u?"":"no")+o):eF(e,"  "+o+"="+u)}else{var h=b(o,a,e,r);h instanceof Error&&eF(e,h.message)}},setlocal:function(e,t){t.setCfg={scope:"local"},this.set(e,t)},setglobal:function(e,t){t.setCfg={scope:"global"},this.set(e,t)},registers:function(e,n){var r=n.args,i=t.registerController.registers,o="----------Registers----------\n\n";if(r)for(var a=r.join(""),s=0;s<a.length;s++){var l=a.charAt(s);if(t.registerController.isValidRegister(l)){var c=i[l]||new Q;o+='"'+l+"    "+c.toString()+"\n"}}else for(var l in i){var u=i[l].toString();u.length&&(o+='"'+l+"    "+u+"\n")}eF(e,o,!0)},marks:function(e,t){var n=t.args,r=e.state.vim.marks,i="-----------Marks-----------\nmark	line	col\n\n";if(n)for(var o=n.join(""),a=0;a<o.length;a++){var s=o.charAt(a),l=r[s]&&r[s].find();l&&(i+=s+"	"+l.line+"	"+l.ch+"\n")}else for(var s in r){var l=r[s]&&r[s].find();l&&(i+=s+"	"+l.line+"	"+l.ch+"\n")}eF(e,i,!0)},sort:function(t,n){var r=function(){if(n.argString){var t=new e.StringStream(n.argString);if(t.eat("!")&&(g=!0),!t.eol()){if(!t.eatSpace())return"Invalid arguments";var r=t.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!r||!t.eol())return"Invalid arguments";if(r[1]){v=-1!=r[1].indexOf("i"),y=-1!=r[1].indexOf("u");var i=-1!=r[1].indexOf("d")||-1!=r[1].indexOf("n"),o=-1!=r[1].indexOf("x"),a=-1!=r[1].indexOf("o");if(Number(i)+Number(o)+Number(a)>1)return"Invalid arguments";C=i&&"decimal"||o&&"hex"||a&&"octal"}r[2]&&(k=new RegExp(r[2].substr(1,r[2].length-2),v?"i":""))}}}();if(r){eF(t,r+": "+n.argString);return}var o=n.line||t.firstLine(),a=n.lineEnd||n.line||t.lastLine();if(o!=a){var s=new i(o,0),l=new i(a,eh(t,a)),c=t.getRange(s,l).split("\n"),u="decimal"==C?/(-?)([\d]+)/:"hex"==C?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==C?/([0-7]+)/:null,h="decimal"==C?10:"hex"==C?16:"octal"==C?8:void 0,d=[],m=[];if(C||k)for(var p=0;p<c.length;p++){var f=k?c[p].match(k):null;f&&""!=f[0]?d.push(f):u&&u.exec(c[p])?d.push(c[p]):m.push(c[p])}else m=c;if(d.sort(k?function(e,t){if(g){var n;n=e,e=t,t=n}return v&&(e[0]=e[0].toLowerCase(),t[0]=t[0].toLowerCase()),e[0]<t[0]?-1:1}:S),k)for(var p=0;p<d.length;p++)d[p]=d[p].input;else C||m.sort(S);if(c=g?d.concat(m):m.concat(d),y){var g,v,y,C,k,w,x=c;c=[];for(var p=0;p<x.length;p++)x[p]!=w&&c.push(x[p]),w=x[p]}t.replaceRange(c.join("\n"),s,l)}function S(e,t){if(g){var n;n=e,e=t,t=n}v&&(e=e.toLowerCase(),t=t.toLowerCase());var r=u&&u.exec(e),i=u&&u.exec(t);return r&&i?parseInt((r[1]+r[2]).toLowerCase(),h)-parseInt((i[1]+i[2]).toLowerCase(),h):e<t?-1:1}},vglobal:function(e,t){this.global(e,t)},normal:function(e,t){var n=!1,r=t.argString;if(r&&"!"==r[0]&&(r=r.slice(1),n=!0),!(r=r.trimStart())){eF(e,"Argument is required.");return}var i=t.line;if("number"==typeof i)for(var o=isNaN(t.lineEnd)?i:t.lineEnd,a=i;a<=o;a++)e.setCursor(a,0),P(e,t.argString.trimStart(),{noremap:n}),e.state.vim.insertMode&&eZ(e,!0);else P(e,t.argString.trimStart(),{noremap:n}),e.state.vim.insertMode&&eZ(e,!0)},global:function(e,t){var n=t.argString;if(!n){eF(e,"Regular Expression missing from global");return}var r="v"===t.commandName[0];"!"===n[0]&&"g"===t.commandName[0]&&(r=!0,n=n.slice(1));var i=void 0!==t.line?t.line:e.firstLine(),o=t.lineEnd||t.line||e.lastLine(),a=eI(n,"/"),s=n,l="";if(a&&a.length&&(s=a[0],l=a.slice(1,a.length).join("/")),s)try{e_(e,s,!0,!0)}catch(t){eF(e,"Invalid regex: "+s);return}for(var c=eB(e).getQuery(),u=[],h=i;h<=o;h++){var d=e.getLine(h);c.test(d)!==r&&u.push(l?e.getLineHandle(h):d)}if(!l){eF(e,u.join("\n"));return}var m=0,p=function(){if(m<u.length){var t=u[m++],n=e.getLineNumber(t);if(null==n){p();return}var r=n+1+l;eG.processCommand(e,r,{callback:p})}else e.releaseLineHandles&&e.releaseLineHandles()};p()},substitute:function(n,r){if(!n.getSearchCursor)throw Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var o,a,s,l=r.argString,c=l?eI(l,l[0]):[],u="",h="",m=!1,p=!1;if(c&&c.length)u=c[0],A("pcre")&&""!==u&&(u=new RegExp(u).source),void 0!==(h=c[1])&&(h=A("pcre")?function(t){for(var n=new e.StringStream(t),r=[];!n.eol();){for(;n.peek()&&"\\"!=n.peek();)r.push(n.next());var i=!1;for(var o in eP)if(n.match(o,!0)){i=!0,r.push(eP[o]);break}i||r.push(n.next())}return r.join("")}(h.replace(/([^\\])&/g,"$1$$&")):function(e){for(var t=!1,n=[],r=-1;r<e.length;r++){var i=e.charAt(r)||"",o=e.charAt(r+1)||"";eD[i+o]?(n.push(eD[i+o]),r++):t?(n.push(i),t=!1):"\\"===i?(t=!0,d.test(o)||"$"===o)?n.push("$"):"/"!==o&&"\\"!==o&&n.push("\\"):("$"===i&&n.push("$"),n.push(i),"/"===o&&n.push("\\"))}return n.join("")}(h),t.lastSubstituteReplacePart=h),o=c[2]?c[2].split(" "):[];else if(l&&l.length){eF(n,"Substitutions should be of the form :s/pattern/replace/");return}if(o&&(a=o[0],s=parseInt(o[1]),a&&(-1!=a.indexOf("c")&&(m=!0),-1!=a.indexOf("g")&&(p=!0),u=A("pcre")?u+"/"+a:u.replace(/\//g,"\\/")+"/"+a)),u)try{e_(n,u,!0,!0)}catch(e){eF(n,"Invalid regex: "+u);return}if(void 0===(h=h||t.lastSubstituteReplacePart)){eF(n,"No previous substitute regular expression");return}var f=eB(n).getQuery(),g=void 0!==r.line?r.line:n.getCursor().line,v=r.lineEnd||g;g==n.firstLine()&&v==n.lastLine()&&(v=1/0),s&&(v=(g=v)+s-1);var y=et(n,new i(g,0)),C=n.getSearchCursor(f,y);!function(t,n,r,i,o,a,s,l,c){t.state.vim.exMode=!0;var u,h,d,m=!1,p=0;function f(){t.operation(function(){for(;!m;)g(),v();y()})}function g(){var e="",n=a.match||a.pos&&a.pos.match;e=n?l.replace(/\$(\d{1,3}|[$&])/g,function(e,t){if("$"==t)return"$";if("&"==t)return n[0];for(var r=t;parseInt(r)>=n.length&&r.length>0;)r=r.slice(0,r.length-1);return r?n[r]+t.slice(r.length,t.length):e}):t.getRange(a.from(),a.to()).replace(s,l);var r=a.to().line;a.replace(e),h=a.to().line,o+=h-r,d=h<r}function v(){for(var e,n,s,l;e=u&&eo(a.to()),(n=a.findNext())&&!n[0]&&e&&ea(a.from(),e)&&(n=a.findNext()),n&&p++,n&&(s=a.from(),l=o,("number"!=typeof s&&(s=s.line),i instanceof Array)?S(s,i):"number"==typeof l?s>=i&&s<=l:s==i);)if(r||a.from().line!=h||d){t.scrollIntoView(a.from(),30),t.setSelection(a.from(),a.to()),u=a.from(),m=!1;return}m=!0}function y(e){if(e&&e(),t.focus(),u){t.setCursor(u);var n=t.state.vim;n.exMode=!1,n.lastHPos=n.lastHSPos=u.ch}c?c():m&&eF(t,(p?"Found "+p+" matches":"No matches found")+" for pattern: "+s+(A("pcre")?" (set nopcre to use Vim regexps)":""))}if(v(),m){eF(t,"No matches for "+s+(A("pcre")?" (set nopcre to use vim regexps)":""));return}if(!n){f(),c&&c();return}eV(t,{prefix:ej("span","replace with ",ej("strong",l)," (y/n/a/q/l)"),onKeyDown:function(n,r,i){switch(e.e_stop(n),V(n)){case"y":g(),v();break;case"n":v();break;case"a":var o=c;c=void 0,t.operation(f),c=o;break;case"l":g();case"q":case"<Esc>":case"<C-c>":case"<C-[>":y(i)}return m&&y(i),!0}})}(n,m,p,g,v,C,f,h,r.callback)},startinsert:function(e,t){P(e,"!"==t.argString?"A":"i",{})},redo:e.commands.redo,undo:e.commands.undo,write:function(t){e.commands.save?e.commands.save(t):t.save&&t.save()},nohlsearch:function(e){eq(e)},yank:function(e){var n=eo(e.getCursor()).line,r=e.getLine(n);t.registerController.pushText("0","yank",r,!0,!0)},delete:function(e,t){var n=t.selectionLine,r=isNaN(t.selectionLineEnd)?n:t.selectionLineEnd;Z.delete(e,{linewise:!0},[{anchor:new i(n,0),head:new i(r+1,0)}])},join:function(e,t){var n=t.selectionLine,r=isNaN(t.selectionLineEnd)?n:t.selectionLineEnd;e.setCursor(new i(n,0)),ee.joinLines(e,{repeat:r-n},e.state.vim)},delmarks:function(t,n){if(!n.argString||!ed(n.argString)){eF(t,"Argument required");return}for(var r=t.state.vim,i=new e.StringStream(ed(n.argString));!i.eol();){i.eatSpace();var o=i.pos;if(!i.match(/[a-zA-Z]/,!1)){eF(t,"Invalid argument: "+n.argString.substring(o));return}var a=i.next();if(i.match("-",!0)){if(!i.match(/[a-zA-Z]/,!1)){eF(t,"Invalid argument: "+n.argString.substring(o));return}var s=i.next();if(a&&s&&k(a)==k(s)){var l=a.charCodeAt(0),c=s.charCodeAt(0);if(l>=c){eF(t,"Invalid argument: "+n.argString.substring(o));return}for(var u=0;u<=c-l;u++){var h=String.fromCharCode(l+u);delete r.marks[h]}}else{eF(t,"Invalid argument: "+a+"-");return}}else a&&delete r.marks[a]}}},eG=new eX;function eZ(n,r){var i=n.state.vim,o=t.macroModeState,a=t.registerController.getRegister("."),s=o.isPlaying,l=o.lastInsertModeChanges;s||(n.off("change",e1),i.insertEnd&&i.insertEnd.clear(),i.insertEnd=void 0,e.off(n.getInputField(),"keydown",e3)),!s&&i.insertModeRepeat&&i.insertModeRepeat>1&&(e5(n,i,i.insertModeRepeat-1,!0),i.lastEditInputState.repeatOverride=i.insertModeRepeat),delete i.insertModeRepeat,i.insertMode=!1,r||n.setCursor(n.getCursor().line,n.getCursor().ch-1),n.setOption("keyMap","vim"),n.setOption("disableInput",!0),n.toggleOverwrite(!1),a.setText(l.changes.join("")),e.signal(n,"vim-mode-change",{mode:"normal"}),o.isRecording&&function(e){if(!e.isPlaying){var n=e.latestRegister,r=t.registerController.getRegister(n);r&&r.pushInsertModeChanges&&r.pushInsertModeChanges(e.lastInsertModeChanges)}}(o)}function e0(e){a.unshift(e),e.keys&&function(e){e.split(/(<(?:[CSMA]-)*\w+>|.)/i).forEach(function(e){e&&(s[e]||(s[e]=0),s[e]++)})}(e.keys)}function e1(e,n){var r=t.macroModeState,i=r.lastInsertModeChanges;if(!r.isPlaying)for(var o=e.state.vim;n;){if(i.expectCursorActivityForChange=!0,i.ignoreCount>1)i.ignoreCount--;else if("+input"==n.origin||"paste"==n.origin||void 0===n.origin){var a=e.listSelections().length;a>1&&(i.ignoreCount=a);var s=n.text.join("\n");if(i.maybeReset&&(i.changes=[],i.maybeReset=!1),s){if(e.state.overwrite&&!/\n/.test(s))i.changes.push([s]);else{if(s.length>1){var l=o&&o.insertEnd&&o.insertEnd.find(),c=e.getCursor();if(l&&l.line==c.line){var u=l.ch-c.ch;u>0&&u<s.length&&(i.changes.push([s,u]),s="")}}s&&i.changes.push(s)}}}n=n.next}}function e6(e){var n=e.state.vim;if(n.insertMode){var r=t.macroModeState;if(r.isPlaying)return;var i=r.lastInsertModeChanges;i.expectCursorActivityForChange?i.expectCursorActivityForChange=!1:(i.maybeReset=!0,n.insertEnd&&n.insertEnd.clear(),n.insertEnd=e.setBookmark(e.getCursor(),{insertLeft:!0}))}else e.curOp?.isVimOp||e2(e,n)}function e2(t,n){var r=t.getCursor("anchor"),i=t.getCursor("head");if(n.visualMode&&!t.somethingSelected()?ey(t,!1):!n.visualMode&&!n.insertMode&&t.somethingSelected()&&(n.visualMode=!0,n.visualLine=!1,e.signal(t,"vim-mode-change",{mode:"visual"})),n.visualMode){var o=es(i,r)?0:-1,a=es(i,r)?-1:0;i=er(i,0,o),r=er(r,0,a),n.sel={anchor:r,head:i},eE(t,n,"<",el(i,r)),eE(t,n,">",ec(i,r))}else n.insertMode||(n.lastHPos=t.getCursor().ch)}function e3(n){var r=t.macroModeState.lastInsertModeChanges,i=e.keyName?e.keyName(n):n.key;i&&(-1!=i.indexOf("Delete")||-1!=i.indexOf("Backspace"))&&(r.maybeReset&&(r.changes=[],r.maybeReset=!1),r.changes.push(new B(i,n)))}function e5(e,n,r,i){var o=t.macroModeState;o.isPlaying=!0;var a=n.lastEditActionCommand,s=n.inputState;function l(){a?X.processAction(e,n,a):X.evalInput(e,n)}function c(t){o.lastInsertModeChanges.changes.length>0&&(t=n.lastEditActionCommand?t:1,e9(e,o.lastInsertModeChanges.changes,t))}if(n.inputState=n.lastEditInputState,a&&a.interlaceInsertRepeat)for(var u=0;u<r;u++)l(),c(1);else i||l(),c(r);n.inputState=s,n.insertMode&&!i&&eZ(e),o.isPlaying=!1}function e8(t,n){e.lookupKey(n,"vim-insert",function(n){return"string"==typeof n?e.commands[n](t):n(t),!0})}function e9(e,n,r){var i=e.getCursor("head"),o=t.macroModeState.lastInsertModeChanges.visualBlock;o&&(ep(e,i,o+1),r=e.listSelections().length,e.setCursor(i));for(var a=0;a<r;a++){o&&e.setCursor(er(i,a,0));for(var s=0;s<n.length;s++){var l=n[s];if(l instanceof B)e8(e,l.keyName);else if("string"==typeof l)e.replaceSelection(l);else{var c=e.getCursor(),u=er(c,0,l[0].length-(l[1]||0));e.replaceRange(l[0],c,l[1]?c:u),e.setCursor(u)}}}o&&e.setCursor(er(i,0,1))}function e4(e){var t=new e.constructor;return Object.keys(e).forEach(function(n){if("insertEnd"!=n){var r=e[n];Array.isArray(r)?r=r.slice():r&&"object"==typeof r&&r.constructor!=Object&&(r=e4(r)),t[n]=r}}),e.sel&&(t.sel={head:e.sel.head&&eo(e.sel.head),anchor:e.sel.anchor&&eo(e.sel.anchor)}),t}return I.defineEx("version","ve",e=>{eF(e,"Codemirror-vim version: 6.3.0")}),L("insertModeEscKeysTimeout",200,"number"),N(),I}(C),B=s.tk.baseTheme({".cm-vimMode .cm-cursorLayer:not(.cm-vimCursorLayer)":{display:"none"},".cm-vim-panel":{padding:"0px 10px",fontFamily:"monospace",minHeight:"1.3em",display:"flex"},".cm-vim-panel input":{border:"none",outline:"none",backgroundColor:"inherit"},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"}}),I=s.lg.fromClass(class{constructor(e){this.status="",this.query=null,this.decorations=s.p.none,this.waitForCopy=!1,this.lastKeydown="",this.useNextTextInput=!1,this.compositionText="",this.view=e;let t=this.cm=new C(e);N.enterVimMode(this.cm),this.view.cm=this.cm,this.cm.state.vimPlugin=this,this.blockCursor=new O(e,t),this.updateClass(),this.cm.on("vim-command-done",()=>{t.state.vim&&(t.state.vim.status=""),this.blockCursor.scheduleRedraw(),this.updateStatus()}),this.cm.on("vim-mode-change",e=>{t.state.vim&&(t.state.vim.mode=e.mode,e.subMode&&(t.state.vim.mode+=" block"),t.state.vim.status="",this.blockCursor.scheduleRedraw(),this.updateClass(),this.updateStatus())}),this.cm.on("dialog",()=>{this.cm.state.statusbar?this.updateStatus():e.dispatch({effects:D.of(!!this.cm.state.dialog)})}),this.dom=document.createElement("span"),this.spacer=document.createElement("span"),this.spacer.style.flex="1",this.statusButton=document.createElement("span"),this.statusButton.onclick=e=>{N.handleKey(this.cm,"<Esc>","user"),this.cm.focus()},this.statusButton.style.cssText="cursor: pointer"}update(e){var t;if((e.viewportChanged||e.docChanged)&&this.query&&this.highlight(this.query),e.docChanged&&this.cm.onChange(e),e.selectionSet&&this.cm.onSelectionChange(),e.viewportChanged,this.cm.curOp&&!this.cm.curOp.isVimOp&&this.cm.onBeforeEndOperation(),e.transactions){for(let n of e.transactions)for(let e of n.effects)if(e.is(l.ql)){if(null===(t=e.value)||void 0===t?void 0:t.forVim){let t=e.value.create();this.highlight(t)}else this.highlight(null)}}this.blockCursor.update(e)}updateClass(){let e=this.cm.state;e.vim&&(!e.vim.insertMode||e.overwrite)?this.view.scrollDOM.classList.add("cm-vimMode"):this.view.scrollDOM.classList.remove("cm-vimMode")}updateStatus(){let e=this.cm.state.statusbar,t=this.cm.state.vim;if(!e||!t)return;let n=this.cm.state.dialog;if(n)n.parentElement!=e&&(e.textContent="",e.appendChild(n));else{e.textContent="";var r=(t.mode||"normal").toUpperCase();t.insertModeReturn&&(r+="(C-O)"),this.statusButton.textContent=`--${r}--`,e.appendChild(this.statusButton),e.appendChild(this.spacer)}this.dom.textContent=t.status,e.appendChild(this.dom)}destroy(){N.leaveVimMode(this.cm),this.updateClass(),this.blockCursor.destroy(),delete this.view.cm}highlight(e){if(this.query=e,!e)return this.decorations=s.p.none;let{view:t}=this,n=new o.f_;for(let r=0,i=t.visibleRanges,o=i.length;r<o;r++){let{from:a,to:s}=i[r];for(;r<o-1&&s>i[r+1].from-500;)s=i[++r].to;e.highlight(t.state,a,s,(e,t)=>{n.add(e,t,K)})}return this.decorations=n.finish()}handleKey(e,t){let n=this.cm,r=n.state.vim;if(!r)return;let i=N.vimKeyFromEvent(e,r);if(C.signal(this.cm,"inputEvent",{type:"handleKey",key:i}),!i)return;if("<Esc>"==i&&!r.insertMode&&!r.visualMode&&this.query){let e=r.searchState_;e&&(n.removeOverlay(e.getOverlay()),e.setOverlay(null))}if("<C-c>"===i&&!C.isMac&&n.somethingSelected())return this.waitForCopy=!0,!0;r.status=(r.status||"")+i;let o=N.multiSelectHandleKey(n,i,"user");return r=N.maybeInitVimState_(n),!o&&r.insertMode&&n.state.overwrite&&(e.key&&1==e.key.length&&!/\n/.test(e.key)?(o=!0,n.overWriteSelection(e.key)):"Backspace"==e.key&&(o=!0,C.commands.cursorCharLeft(n))),o&&(C.signal(this.cm,"vim-keypress",i),e.preventDefault(),e.stopPropagation(),this.blockCursor.scheduleRedraw()),this.updateStatus(),!!o}},{eventHandlers:{copy:function(e,t){this.waitForCopy&&(this.waitForCopy=!1,Promise.resolve().then(()=>{var e=this.cm,t=e.state.vim;t&&(t.insertMode?e.setSelection(e.getCursor(),e.getCursor()):e.operation(()=>{e.curOp&&(e.curOp.isVimOp=!0),N.handleKey(e,"<Esc>","user")}))}))},compositionstart:function(e,t){this.useNextTextInput=!0,C.signal(this.cm,"inputEvent",e)},compositionupdate:function(e,t){C.signal(this.cm,"inputEvent",e)},compositionend:function(e,t){C.signal(this.cm,"inputEvent",e)},keypress:function(e,t){C.signal(this.cm,"inputEvent",e),"Dead"==this.lastKeydown&&this.handleKey(e,t)},keydown:function(e,t){C.signal(this.cm,"inputEvent",e),this.lastKeydown=e.key,"Unidentified"==this.lastKeydown||"Process"==this.lastKeydown||"Dead"==this.lastKeydown?this.useNextTextInput=!0:(this.useNextTextInput=!1,this.handleKey(e,t))}},provide:()=>[s.tk.inputHandler.of((e,t,n,r)=>{var i,o,a=V(e);if(!a)return!1;var s=null===(i=a.state)||void 0===i?void 0:i.vim,l=a.state.vimPlugin;if(s&&!s.insertMode&&!(null===(o=a.curOp)||void 0===o?void 0:o.isVimOp)){if("\0\0"===r)return!0;if(C.signal(a,"inputEvent",{type:"text",text:r,from:t,to:n}),1==r.length&&l.useNextTextInput){if(s.expectLiteralNext&&e.composing)return l.compositionText=r,!1;if(l.compositionText){var c=l.compositionText;l.compositionText="";var u=e.state.selection.main.head,h=e.state.sliceDoc(u-c.length,u);if(c===h){var d=a.getCursor();a.replaceRange("",a.posFromIndex(u-c.length),d)}}return l.handleKey({key:r,preventDefault:()=>{},stopPropagation:()=>{}}),function(e){var t=e.scrollDOM.parentElement;if(t){if(R){e.contentDOM.textContent="\0\0",e.contentDOM.dispatchEvent(new CustomEvent("compositionend"));return}var n=e.scrollDOM.nextSibling,r=window.getSelection(),i=r&&{anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset};e.scrollDOM.remove(),t.insertBefore(e.scrollDOM,n);try{i&&r&&(r.setPosition(i.anchorNode,i.anchorOffset),i.focusNode&&r.extend(i.focusNode,i.focusOffset))}catch(e){console.error(e)}e.focus(),e.contentDOM.dispatchEvent(new CustomEvent("compositionend"))}}(e),!0}}return!1})],decorations:e=>e.decorations}),K=s.p.mark({class:"cm-searchMatch"}),D=o.Py.define(),P=o.QQ.define({create:()=>!1,update(e,t){for(let n of t.effects)n.is(D)&&(e=n.value);return e},provide:e=>s.mH.from(e,e=>e?H:null)});function H(e){let t=document.createElement("div");t.className="cm-vim-panel";let n=e.cm;return n.state.dialog&&t.appendChild(n.state.dialog),{top:!1,dom:t}}function j(e){let t=document.createElement("div");t.className="cm-vim-panel";let n=e.cm;return n.state.statusbar=t,n.state.vimPlugin.updateStatus(),{dom:t}}function F(e={}){return[B,I,T,e.status?s.mH.of(j):P]}function V(e){return e.cm||null}}}]);